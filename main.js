!function(){"use strict";function e(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const t="popup_active";class s{constructor(e){this._selector=e,this._modal=document.querySelector("".concat(this._selector)),this._handleEscKey=this._handleEscKey.bind(this),this._handleClosePopup=this._handleClosePopup.bind(this)}_handleEscKey(e){"Escape"===e.key&&this.close()}setEventListeners(){this._modal.addEventListener("mouseup",this._handleClosePopup)}_handleClosePopup(e){e.target.classList.contains(t)&&this.close(),e.target.classList.contains("popup__container-close")&&this.close()}open(){document.addEventListener("keyup",this._handleEscKey),this._modal.classList.add(t)}close(){document.removeEventListener("keyup",this._handleEscKey),this._modal.classList.remove(t)}}class i extends s{constructor(e){let{selector:t,handleSubmit:s,loadingBtnText:i}=e;super(t),this._handleSubmit=s,this._handleSubmit=this._handleSubmit.bind(this),this._handlerWithForm=this._handlerWithForm.bind(this),this._form=this._modal.querySelector(".popup__form"),this._inputFields=[...this._form.querySelectorAll(".popup__form-field")],this._submitBtn=this._modal.querySelector(".popup__form-submit"),this._btnInitText=this._submitBtn.textContent,this._loadingBtnText=i}_getInputValues(){const e={};return this._inputFields.forEach((t=>{e[t.id]=t.value})),e}open(e){e&&this._setInputValues(e),super.open()}_setInputValues(e){this._inputFields.forEach((t=>{Object.keys(e).forEach((s=>{t.id===s&&(t.value=e[s])}))}))}_handlerWithForm(e){e.preventDefault(),this._handleSubmit(this._getInputValues())}showLoading(){this._submitBtn.textContent=this._loadingBtnText}hideLoading(){this._submitBtn.textContent=this._btnInitText}setEventListeners(){this._form.addEventListener("submit",this._handlerWithForm),super.setEventListeners()}close(){super.close(),setTimeout((()=>this._form.reset()),500)}}const n=document.querySelector(".profile__edit-button"),r=document.querySelector(".profile__add-btn"),o=document.querySelector(".profile__picture-button"),a=new class{constructor(e){let{baseURL:t,headers:s}=e;var i,n;n=e=>e.ok?e.json():Promise.reject("Error: ".concat(e.statusText)),(i="_processResponse")in this?Object.defineProperty(this,i,{value:n,enumerable:!0,configurable:!0,writable:!0}):this[i]=n,this._baseURL=t,this._headers=s}getUserInfo(){return fetch("".concat(this._baseURL,"/users/me"),{headers:this._headers}).then(this._processResponse)}getInitialCards(){return fetch("".concat(this._baseURL,"/cards"),{headers:this._headers}).then((e=>this._processResponse(e)))}patchUserInfo(e){return fetch("".concat(this._baseURL,"users/me"),{headers:this._headers,method:"PATCH",body:JSON.stringify(e)}).then((e=>this._processResponse(e)))}postNewCard(e){return fetch("".concat(this._baseURL,"/cards"),{headers:this._headers,method:"POST",body:JSON.stringify(e)}).then((e=>this._processResponse(e)))}deleteCard(e){return fetch("".concat(this._baseURL,"/cards/").concat(e),{headers:this._headers,method:"DELETE"}).then((e=>this._processResponse(e)))}addLike(e){return fetch("".concat(this._baseURL,"cards/likes/").concat(e),{headers:this._headers,method:"PUT"}).then((e=>this._processResponse(e)))}removeLike(e){return fetch("".concat(this._baseURL,"cards/likes/").concat(e),{headers:this._headers,method:"DELETE"}).then((e=>this._processResponse(e)))}changeAvatar(e){return fetch("".concat(this._baseURL,"users/me/avatar"),{headers:this._headers,method:"PATCH",body:JSON.stringify({avatar:e})}).then((e=>this._processResponse(e)))}getInitialData(){return Promise.all([a.getUserInfo(),a.getInitialCards()])}}({baseURL:"https://around.nomoreparties.co/v1/cohort-3-en/",headers:{authorization:"".concat("a71d10a8-c3e4-4a43-bbbc-db81e488ab20"),"Content-Type":"application/json"}}),h=new class{constructor(e){let{renderer:t,selector:s}=e;this._renderer=t,this._container=document.querySelector(s)}addItem(e){const t=this._renderer(e);this._container.prepend(t)}_clear(){this._container.innerHTML=""}renderAll(e){this._clear(),e.forEach((e=>{this.addItem(e)}))}}({renderer:function(e){const t=new class{constructor(e,t){let{data:s,handleImg:i,handleDel:n,handleLike:r,userId:o}=e;this._name=s.name,this._src=s.link,this._likesArr=s.likes,this._id=s._id,this.ownerId=s.owner._id,this._selector=t,this._hanldeImgClick=i,this._handleDel=n,this._handleLikeBtn=r,this._userId=o}_getTemplate(){return document.querySelector("".concat(this._selector)).content.cloneNode(!0)}makeCard(){return this._element=this._getTemplate().querySelector(".card"),this._img=this._element.querySelector(".card__img"),this._caption=this._element.querySelector(".card__caption"),this._trash=this._element.querySelector(".card__trash"),this._like=this._element.querySelector(".card__like-btn"),this._likes=this._element.querySelector(".card__like-counter"),this._img.setAttribute("src",this._src),this._img.setAttribute("alt",this._name),this._caption.textContent=this._name,this._updateLikes(this._likesArr),this._addListeners(),this._userId!=this.ownerId&&(this._trash.classList.add("trash_display-none"),this._trash.setAttribute("disabled","")),this._element.setAttribute("id",this._id),this._element}_addListeners(){this._like.addEventListener("click",(()=>this._handleLikeBtn())),this._img.addEventListener("click",(()=>this._hanldeImgClick({name:this._name,src:this._src}))),this._trash.addEventListener("click",(()=>this._handleDel(this._id)))}_updateLikes(e){this._likesArr=e,this._likesCount=e.length,this._renderLikes()}_isLiked(){return this._likesArr.some((e=>e._id===this._userId))}_renderLikes(){this._likes.textContent=this._likesCount,this._isLiked()?this._like.classList.add("card__like-btn_active"):this._like.classList.remove("card__like-btn_active")}remove(){this._element.remove(),this._element=null}}({data:e,userId:m.getUserId(),handleImg:e=>{l.open(e)},handleDel:e=>{u.open(),u.setAction((()=>{u.showLoading(),a.deleteCard(e).then((()=>{t.remove(),u.close()})).catch((e=>console.log(e))).finally((()=>u.hideLoading()))}))},handleLike:()=>{t._isLiked()?a.removeLike(t._id).then((e=>{t._updateLikes(e.likes)})).catch(console.error):a.addLike(t._id).then((e=>{t._updateLikes(e.likes)})).catch(console.error)}},"#card");return t.makeCard()},selector:".gallery"}),l=new class extends s{constructor(e){super(e),this._image=this._modal.querySelector(".img-popout__img"),this._caption=this._modal.querySelector(".img-popout__caption")}open(e){this._image.src=e.src,this._image.alt=e.name,this._caption.textContent=e.name,super.open()}}("#imgPopup");l.setEventListeners();const c=new i({selector:"#avatar",handleSubmit:e=>{c.showLoading(),a.changeAvatar(e.avatarLink).then((e=>{m.setUserInfo(e),c.close()})).catch((e=>console.log(e))).finally((()=>c.hideLoading()))},loadingBtnText:"Saving..."});c.setEventListeners();const d=new i({selector:"#profilePopup",handleSubmit:e=>{d.showLoading(),a.patchUserInfo(e).then((e=>{m.setUserInfo(e),d.close()})).catch((e=>console.log(e))).finally((()=>d.hideLoading()))},loadingBtnText:"Saving..."});d.setEventListeners();const _=new i({selector:"#addCardPopup",handleSubmit:e=>{_.showLoading(),a.postNewCard({name:e.title,link:e.imgLink}).then((e=>{h.addItem(e),_.close()})).catch((e=>console.log(e))).finally((()=>addCard.hideLoading()))},loadingBtnText:"Saving..."});_.setEventListeners();const u=new class extends s{constructor(e){let{selector:t,loadingBtnText:s}=e;super(t),this._submitBtn=this._modal.querySelector(".popup__form-submit"),this._btnInitText=this._submitBtn.textContent,this._loadingBtnText=s}setAction(e){this._handleSubmit=e}showLoading(){this._submitBtn.textContent=this._loadingBtnText}hideLoading(){this._submitBtn.textContent=this._btnInitText}setEventListeners(){this._modal.querySelector(".popup__form-submit").addEventListener("mouseup",(e=>{this._handleSubmit(e)})),super.setEventListeners()}}({selector:"#cardDelete",loadingBtnText:"Deleting..."});u.setEventListeners();const m=new class{constructor(e){this._nameSelector=e.nameSelector,this._jobSelector=e.jobSelector,this._nameNode=document.querySelector("".concat(this._nameSelector)),this._jobNode=document.querySelector("".concat(this._jobSelector)),this._pictureNode=document.querySelector(".profile__picture")}getUserInfo(){return this._name=this._nameNode.textContent,this._job=this._jobNode.textContent,{name:this._name,about:this._job}}setUserInfo(e){this._nameNode.textContent=e.name,this._jobNode.textContent=e.about}setUserAvatar(e){this._pictureNode.src=e}getUserId(){return this._id}setUserId(e){this._id=e}}({nameSelector:".profile__user-name",jobSelector:".profile__user-about"}),p={};var b;b={formSelector:".popup__form",inputSelector:".popup__form-field",submitButtonSelector:".popup__form-submit",inactiveButtonClass:"",inputErrorClass:"popup__form-field_error",errorClass:"popup__form-error-msg_inactive"},Array.from(document.querySelectorAll(b.formSelector)).forEach((t=>{const s=new class{constructor(t,s){e(this,"_hideOrShowError",(e=>{e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validationMessage)})),e(this,"_showInputError",((e,t)=>{const s=this._formElement.querySelector("#".concat(e.getAttribute("name")));e.classList.add(this._settings.inputErrorClass),s.textContent=t,s.classList.remove(this._settings.errorClass)})),e(this,"_hideInputError",(e=>{const t=this._formElement.querySelector("#".concat(e.getAttribute("name")));e.classList.remove(this._settings.inputErrorClass),t.classList.add(this._settings.errorClass),t.textContent=""})),e(this,"_hasInvalidInput",(e=>e.some((e=>!e.validity.valid)))),this._settings=t,this._formElement=s,this._inputList=Array.from(this._formElement.querySelectorAll(this._settings.inputSelector)),this._btnElement=this._formElement.querySelector(this._settings.submitButtonSelector)}resetValidation(){this._toggleBtnState(),this._inputList.forEach((e=>{this._hideInputError(e)}))}enableValidation(){this._toggleBtnState(),this.resetValidation(),this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._hideOrShowError(e),this._toggleBtnState()}))}))}_toggleBtnState(){this._hasInvalidInput(this._inputList)?this._btnElement.setAttribute("disabled",!0):this._btnElement.removeAttribute("disabled")}}(b,t),i=t.getAttribute("name");p[i]=s,s.enableValidation()})),a.getInitialData().then((e=>{let[t,s]=e;m.setUserInfo(t),m.setUserAvatar(t.avatar),m.setUserId(t._id),h.renderAll(s)})),o.addEventListener("click",(function(){c.open()})),n.addEventListener("click",(function(){const e=m.getUserInfo();d.open(e),p.editProfileForm.resetValidation()})),r.addEventListener("click",(function(){p.addCardForm.resetValidation(),_.open()}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi5qcyIsIm1hcHBpbmdzIjoiaUpBQUEsTUFBTUEsRUFBcUIsZUFHWixNQUFNQyxFQUNuQkMsWUFBWUMsR0FDVkMsS0FBS0MsVUFBWUYsRUFDakJDLEtBQUtFLE9BQVNDLFNBQVNDLGNBQVQsVUFBMEJKLEtBQUtDLFlBQzdDRCxLQUFLSyxjQUFnQkwsS0FBS0ssY0FBY0MsS0FBS04sTUFDN0NBLEtBQUtPLGtCQUFvQlAsS0FBS08sa0JBQWtCRCxLQUFLTixLQUN0RCxDQUVESyxjQUFjRyxHQUNJLFdBQVpBLEVBQUlDLEtBQ05ULEtBQUtVLE9BRVIsQ0FFREMsb0JBQ0VYLEtBQUtFLE9BQU9VLGlCQUFpQixVQUFXWixLQUFLTyxrQkFDOUMsQ0FFREEsa0JBQWtCQyxHQUNaQSxFQUFJSyxPQUFPQyxVQUFVQyxTQUFTbkIsSUFDaENJLEtBQUtVLFFBRUhGLEVBQUlLLE9BQU9DLFVBQVVDLFNBeEJJLDJCQXlCM0JmLEtBQUtVLE9BRVIsQ0FFRE0sT0FDRWIsU0FBU1MsaUJBQWlCLFFBQVNaLEtBQUtLLGVBQ3hDTCxLQUFLRSxPQUFPWSxVQUFVRyxJQUFJckIsRUFDM0IsQ0FFRGMsUUFDRVAsU0FBU2Usb0JBQW9CLFFBQVNsQixLQUFLSyxlQUMzQ0wsS0FBS0UsT0FBT1ksVUFBVUssT0FBT3ZCLEVBQzlCLEVDakNZLE1BQU13QixVQUFzQnZCLEVBQ3pDQyxZQUFZLEdBQTRDLElBQTVDLFNBQUVDLEVBQUYsYUFBWXNCLEVBQVosZUFBMEJDLEdBQWtCLEVBQ3REQyxNQUFNeEIsR0FDTkMsS0FBS3dCLGNBQWdCSCxFQUNyQnJCLEtBQUt3QixjQUFnQnhCLEtBQUt3QixjQUFjbEIsS0FBS04sTUFDN0NBLEtBQUt5QixpQkFBbUJ6QixLQUFLeUIsaUJBQWlCbkIsS0FBS04sTUFDbkRBLEtBQUswQixNQUFRMUIsS0FBS0UsT0FBT0UsY0FUUCxnQkFVbEJKLEtBQUsyQixhQUFlLElBQ2YzQixLQUFLMEIsTUFBTUUsaUJBVmMsdUJBWTlCNUIsS0FBSzZCLFdBQWE3QixLQUFLRSxPQUFPRSxjQUFjLHVCQUM1Q0osS0FBSzhCLGFBQWU5QixLQUFLNkIsV0FBV0UsWUFDcEMvQixLQUFLZ0MsZ0JBQWtCVixDQUN4QixDQUVEVyxrQkFDRSxNQUFNQyxFQUFjLENBQUMsRUFJckIsT0FIQWxDLEtBQUsyQixhQUFhUSxTQUFTQyxJQUN6QkYsRUFBWUUsRUFBTUMsSUFBTUQsRUFBTUUsS0FBOUIsSUFFS0osQ0FDUixDQUVEbEIsS0FBS3VCLEdBQ0NBLEdBQU12QyxLQUFLd0MsZ0JBQWdCRCxHQUMvQmhCLE1BQU1QLE1BQ1AsQ0FFRHdCLGdCQUFnQkMsR0FDZHpDLEtBQUsyQixhQUFhUSxTQUFTQyxJQUN6Qk0sT0FBT0MsS0FBS0YsR0FBUU4sU0FBUzFCLElBQ3ZCMkIsRUFBTUMsS0FBTzVCLElBQ2YyQixFQUFNRSxNQUFRRyxFQUFPaEMsR0FDdEIsR0FISCxHQU1ILENBRURnQixpQkFBaUJqQixHQUViQSxFQUFJb0MsaUJBQ0o1QyxLQUFLd0IsY0FBY3hCLEtBQUtpQyxrQkFFM0IsQ0FFRFksY0FDRTdDLEtBQUs2QixXQUFXRSxZQUFjL0IsS0FBS2dDLGVBQ3BDLENBRURjLGNBQ0U5QyxLQUFLNkIsV0FBV0UsWUFBYy9CLEtBQUs4QixZQUNwQyxDQUVEbkIsb0JBQ0VYLEtBQUswQixNQUFNZCxpQkFBaUIsU0FBVVosS0FBS3lCLGtCQUMzQ0YsTUFBTVosbUJBQ1AsQ0FFREQsUUFDRWEsTUFBTWIsUUFDTnFDLFlBQVcsSUFBTS9DLEtBQUswQixNQUFNc0IsU0FBUyxJQUN0QyxFQ2xFSCxNQUNNQyxFQUFpQjlDLFNBQVNDLGNBQWMseUJBQ3hDOEMsRUFBYS9DLFNBQVNDLGNBQWMscUJBQ3BDK0MsRUFBb0JoRCxTQUFTQyxjQUFjLDRCQ3VFcENnRCxFQUFNLElBeEVuQixNQUNFdEQsWUFBWSxHQUFzQixJQUF0QixRQUFFdUQsRUFBRixRQUFXQyxHQUFXLEUsVUFLZEMsR0FDWEEsRUFBSUMsR0FBS0QsRUFBSUUsT0FBU0MsUUFBUUMsT0FBUixpQkFBeUJKLEVBQUlLLGMsRUFOMUIsMkIsc0JBQUEsSyx1REFBQSxLLEtBQ2hDNUQsS0FBSzZELFNBQVdSLEVBQ2hCckQsS0FBSzhELFNBQVdSLENBQ2pCLENBTURTLGNBQ0UsT0FBT0MsTUFBTSxHQUFELE9BQUloRSxLQUFLNkQsU0FBVCxhQUE4QixDQUFFUCxRQUFTdEQsS0FBSzhELFdBQVlHLEtBQ25FakUsS0FBS2tFLGlCQUVULENBRURDLGtCQUNFLE9BQU9ILE1BQU0sR0FBRCxPQUFJaEUsS0FBSzZELFNBQVQsVUFBMkIsQ0FBRVAsUUFBU3RELEtBQUs4RCxXQUFZRyxNQUNoRVYsR0FBUXZELEtBQUtrRSxpQkFBaUJYLElBRWxDLENBRURhLGNBQWM3QixHQUNaLE9BQU95QixNQUFNLEdBQUQsT0FBSWhFLEtBQUs2RCxTQUFULFlBQTZCLENBQ3ZDUCxRQUFTdEQsS0FBSzhELFNBQ2RPLE9BQVEsUUFDUkMsS0FBTUMsS0FBS0MsVUFBVWpDLEtBQ3BCMEIsTUFBTVYsR0FBUXZELEtBQUtrRSxpQkFBaUJYLElBQ3hDLENBRURrQixZQUFZbEMsR0FDVixPQUFPeUIsTUFBTSxHQUFELE9BQUloRSxLQUFLNkQsU0FBVCxVQUEyQixDQUNyQ1AsUUFBU3RELEtBQUs4RCxTQUNkTyxPQUFRLE9BQ1JDLEtBQU1DLEtBQUtDLFVBQVVqQyxLQUNwQjBCLE1BQU1WLEdBQVF2RCxLQUFLa0UsaUJBQWlCWCxJQUN4QyxDQUVEbUIsV0FBV3JDLEdBQ1QsT0FBTzJCLE1BQU0sR0FBRCxPQUFJaEUsS0FBSzZELFNBQVQsa0JBQTJCeEIsR0FBTSxDQUMzQ2lCLFFBQVN0RCxLQUFLOEQsU0FDZE8sT0FBUSxXQUNQSixNQUFNVixHQUFRdkQsS0FBS2tFLGlCQUFpQlgsSUFDeEMsQ0FFRG9CLFFBQVF0QyxHQUNOLE9BQU8yQixNQUFNLEdBQUQsT0FBSWhFLEtBQUs2RCxTQUFULHVCQUFnQ3hCLEdBQU0sQ0FDaERpQixRQUFTdEQsS0FBSzhELFNBQ2RPLE9BQVEsUUFDUEosTUFBTVYsR0FBUXZELEtBQUtrRSxpQkFBaUJYLElBQ3hDLENBRURxQixXQUFXdkMsR0FDVCxPQUFPMkIsTUFBTSxHQUFELE9BQUloRSxLQUFLNkQsU0FBVCx1QkFBZ0N4QixHQUFNLENBQ2hEaUIsUUFBU3RELEtBQUs4RCxTQUNkTyxPQUFRLFdBQ1BKLE1BQU1WLEdBQVF2RCxLQUFLa0UsaUJBQWlCWCxJQUN4QyxDQUVEc0IsYUFBYUMsR0FDWCxPQUFPZCxNQUFNLEdBQUQsT0FBSWhFLEtBQUs2RCxTQUFULG1CQUFvQyxDQUM5Q1AsUUFBU3RELEtBQUs4RCxTQUNkTyxPQUFRLFFBQ1JDLEtBQU1DLEtBQUtDLFVBQVUsQ0FBRU0sYUFDdEJiLE1BQU1WLEdBQVF2RCxLQUFLa0UsaUJBQWlCWCxJQUN4QyxDQUVEd0IsaUJBQ0UsT0FBT3JCLFFBQVFzQixJQUFJLENBQUM1QixFQUFJVyxjQUFlWCxFQUFJZSxtQkFDNUMsR0FHd0IsQ0FDekJkLFFBQVMsa0RBQ1RDLFFBQVMsQ0FDUDJCLGNBQWUsR0FBRixPRDdFSCx3Q0M4RVYsZUFBZ0Isc0JDakJkQyxFQUFpQixJQzdEUixNQUNicEYsWUFBWSxHQUF3QixJQUF4QixTQUFFcUYsRUFBRixTQUFZcEYsR0FBWSxFQUNsQ0MsS0FBS29GLFVBQVlELEVBQ2pCbkYsS0FBS3FGLFdBQWFsRixTQUFTQyxjQUFjTCxFQUMxQyxDQUVEdUYsUUFBUUMsR0FDTixNQUFNQyxFQUFPeEYsS0FBS29GLFVBQVVHLEdBQzVCdkYsS0FBS3FGLFdBQVdJLFFBQVFELEVBQ3pCLENBRURFLFNBQ0UxRixLQUFLcUYsV0FBV00sVUFBWSxFQUM3QixDQUVEQyxVQUFVQyxHQUNSN0YsS0FBSzBGLFNBQ0xHLEVBQU0xRCxTQUFTb0QsSUFDYnZGLEtBQUtzRixRQUFRQyxFQUFiLEdBRUgsR0R5Q2dDLENBQ2pDSixTQTlDRixTQUFvQkssR0FDbEIsTUFBTU0sRUFBYyxJRWpCdEIsTUFDRWhHLFlBQVksRUFBb0RDLEdBQVUsSUFBOUQsS0FBRXdDLEVBQUYsVUFBUXdELEVBQVIsVUFBbUJDLEVBQW5CLFdBQThCQyxFQUE5QixPQUEwQ0MsR0FBb0IsRUFDeEVsRyxLQUFLbUcsTUFBUTVELEVBQUs2RCxLQUNsQnBHLEtBQUtxRyxLQUFPOUQsRUFBSytELEtBQ2pCdEcsS0FBS3VHLFVBQVloRSxFQUFLaUUsTUFDdEJ4RyxLQUFLeUcsSUFBTWxFLEVBQUtrRSxJQUNoQnpHLEtBQUswRyxRQUFVbkUsRUFBS29FLE1BQU1GLElBQzFCekcsS0FBS0MsVUFBWUYsRUFDakJDLEtBQUs0RyxnQkFBa0JiLEVBQ3ZCL0YsS0FBSzZHLFdBQWFiLEVBQ2xCaEcsS0FBSzhHLGVBQWlCYixFQUN0QmpHLEtBQUsrRyxRQUFVYixDQUNoQixDQUVEYyxlQUlFLE9BSG9CN0csU0FDakJDLGNBRGlCLFVBQ0FKLEtBQUtDLFlBQ3RCZ0gsUUFBUUMsV0FBVSxFQUV0QixDQUVEQyxXQWlCRSxPQWhCQW5ILEtBQUtvSCxTQUFXcEgsS0FBS2dILGVBQWU1RyxjQUFjLFNBQ2xESixLQUFLcUgsS0FBT3JILEtBQUtvSCxTQUFTaEgsY0FBYyxjQUN4Q0osS0FBS3NILFNBQVd0SCxLQUFLb0gsU0FBU2hILGNBQWMsa0JBQzVDSixLQUFLdUgsT0FBU3ZILEtBQUtvSCxTQUFTaEgsY0FBYyxnQkFDMUNKLEtBQUt3SCxNQUFReEgsS0FBS29ILFNBQVNoSCxjQUFjLG1CQUN6Q0osS0FBS3lILE9BQVN6SCxLQUFLb0gsU0FBU2hILGNBQWMsdUJBQzFDSixLQUFLcUgsS0FBS0ssYUFBYSxNQUFPMUgsS0FBS3FHLE1BQ25DckcsS0FBS3FILEtBQUtLLGFBQWEsTUFBTzFILEtBQUttRyxPQUNuQ25HLEtBQUtzSCxTQUFTdkYsWUFBYy9CLEtBQUttRyxNQUNqQ25HLEtBQUsySCxhQUFhM0gsS0FBS3VHLFdBQ3ZCdkcsS0FBSzRILGdCQUNENUgsS0FBSytHLFNBQVcvRyxLQUFLMEcsVUFDdkIxRyxLQUFLdUgsT0FBT3pHLFVBQVVHLElBQUksc0JBQzFCakIsS0FBS3VILE9BQU9HLGFBQWEsV0FBWSxLQUV2QzFILEtBQUtvSCxTQUFTTSxhQUFhLEtBQU0xSCxLQUFLeUcsS0FDL0J6RyxLQUFLb0gsUUFDYixDQUVEUSxnQkFDRTVILEtBQUt3SCxNQUFNNUcsaUJBQWlCLFNBQVMsSUFBTVosS0FBSzhHLG1CQUNoRDlHLEtBQUtxSCxLQUFLekcsaUJBQWlCLFNBQVMsSUFDbENaLEtBQUs0RyxnQkFBZ0IsQ0FBRVIsS0FBTXBHLEtBQUttRyxNQUFPMEIsSUFBSzdILEtBQUtxRyxTQUVyRHJHLEtBQUt1SCxPQUFPM0csaUJBQWlCLFNBQVMsSUFBTVosS0FBSzZHLFdBQVc3RyxLQUFLeUcsTUFDbEUsQ0FFRGtCLGFBQWFuQixHQUNYeEcsS0FBS3VHLFVBQVVDLEVBQ2Z4RyxLQUFLOEgsWUFBY3RCLEVBQU11QixPQUN6Qi9ILEtBQUtnSSxjQUNOLENBRURDLFdBQ0UsT0FBT2pJLEtBQUt1RyxVQUFVMkIsTUFBTTNDLEdBQVNBLEVBQUtrQixNQUFRekcsS0FBSytHLFNBQ3hELENBRURpQixlQUNFaEksS0FBS3lILE9BQU8xRixZQUFjL0IsS0FBSzhILFlBQzNCOUgsS0FBS2lJLFdBQ1BqSSxLQUFLd0gsTUFBTTFHLFVBQVVHLElBQUkseUJBRXpCakIsS0FBS3dILE1BQU0xRyxVQUFVSyxPQUFPLHdCQUUvQixDQUVEQSxTQUNFbkIsS0FBS29ILFNBQVNqRyxTQUNkbkIsS0FBS29ILFNBQVcsSUFDakIsR0ZyREMsQ0FDRTdFLEtBQU1pRCxFQUNOVSxPQUFRaUMsRUFBU0MsWUFDakJyQyxVQUFZUCxJQUNWNkMsRUFBU3JILEtBQUt3RSxFQUFkLEVBRUZRLFVBQVkzRCxJQUNWaUcsRUFBYXRILE9BQ2JzSCxFQUFhQyxXQUFVLEtBQ3JCRCxFQUFhekYsY0FDYk8sRUFBQUEsV0FDY2YsR0FDWDRCLE1BQUssS0FDSjZCLEVBQVkzRSxTQUNabUgsRUFBYTVILE9BQWIsSUFFRDhILE9BQU9DLEdBQVFDLFFBQVFDLElBQUlGLEtBQzNCRyxTQUFRLElBQU1OLEVBQWF4RixlQVA5QixHQUZGLEVBWUZtRCxXQUFZLEtBQ05ILEVBQVltQyxXQUNkN0UsRUFBQUEsV0FDYzBDLEVBQVlXLEtBQ3ZCeEMsTUFBTTRFLElBQ0wvQyxFQUFZNkIsYUFBYWtCLEVBQVNyQyxNQUFsQyxJQUVEZ0MsTUFBTUUsUUFBUUksT0FFakIxRixFQUFBQSxRQUNXMEMsRUFBWVcsS0FDcEJ4QyxNQUFNNEUsSUFDTC9DLEVBQVk2QixhQUFha0IsRUFBU3JDLE1BQWxDLElBRURnQyxNQUFNRSxRQUFRSSxNQUNsQixHQUdMLFNBRUYsT0FBT2hELEVBQVlxQixVQUNwQixFQUlDcEgsU0FBVSxhQUdOc0ksRUFBVyxJR2hFRixjQUE2QnhJLEVBQzFDQyxZQUFZQyxHQUNWd0IsTUFBTXhCLEdBQ05DLEtBQUsrSSxPQUFTL0ksS0FBS0UsT0FBT0UsY0FBYyxvQkFDeENKLEtBQUtzSCxTQUFXdEgsS0FBS0UsT0FBT0UsY0FBYyx1QkFDM0MsQ0FFRFksS0FBS3VCLEdBQ0h2QyxLQUFLK0ksT0FBT2xCLElBQU10RixFQUFLc0YsSUFDdkI3SCxLQUFLK0ksT0FBT0MsSUFBTXpHLEVBQUs2RCxLQUN2QnBHLEtBQUtzSCxTQUFTdkYsWUFBY1EsRUFBSzZELEtBQ2pDN0UsTUFBTVAsTUFDUCxHSG9EaUMsYUFDcENxSCxFQUFTMUgsb0JBRUYsTUFBTXNJLEVBQXNCLElBQUk3SCxFQUFjLENBQ25EckIsU0FBVSxVQUNWc0IsYUFBZWlGLElBQ2IyQyxFQUFvQnBHLGNBQ3BCTyxFQUFBQSxhQUNnQmtELEVBQUs0QyxZQUNsQmpGLE1BQU1WLElBQ0w0RSxFQUFTZ0IsWUFBWTVGLEdBQ3JCMEYsRUFBb0J2SSxPQUFwQixJQUVEOEgsT0FBT0MsR0FBUUMsUUFBUUMsSUFBSUYsS0FDM0JHLFNBQVEsSUFBT0ssRUFBb0JuRyxlQVB0QyxFQVNGeEIsZUFBZ0IsY0FFbEIySCxFQUFvQnRJLG9CQUViLE1BQU15SSxFQUFjLElBQUloSSxFQUFjLENBQzNDckIsU0FBVSxnQkFDVnNCLGFBQWVrQixJQUNiNkcsRUFBWXZHLGNBQ1pPLEVBQUFBLGNBQ2lCYixHQUNkMEIsTUFBTVYsSUFDTDRFLEVBQVNnQixZQUFZNUYsR0FDckI2RixFQUFZMUksT0FBWixJQUVEOEgsT0FBT0MsR0FBUUMsUUFBUUMsSUFBSUYsS0FFM0JHLFNBQVEsSUFBTVEsRUFBWXRHLGVBUjdCLEVBVUZ4QixlQUFnQixjQUVsQjhILEVBQVl6SSxvQkFFTCxNQUFNMEksRUFBZSxJQUFJakksRUFBYyxDQUM1Q3JCLFNBQVUsZ0JBQ1ZzQixhQUFla0IsSUFDYjhHLEVBQWF4RyxjQUNiTyxFQUFBQSxZQUNlLENBQUVnRCxLQUFNN0QsRUFBSytHLE1BQU9oRCxLQUFNL0QsRUFBS2dILFVBQzNDdEYsTUFBTVYsSUFDTDJCLEVBQWVJLFFBQVEvQixHQUN2QjhGLEVBQWEzSSxPQUFiLElBRUQ4SCxPQUFPQyxHQUFRQyxRQUFRQyxJQUFJRixLQUUzQkcsU0FBUSxJQUFPWSxRQUFRMUcsZUFSMUIsRUFVRnhCLGVBQWdCLGNBRWxCK0gsRUFBYTFJLG9CQUVOLE1BQU0ySCxFQUFlLElJeEhyQixjQUF3QnpJLEVBQzdCQyxZQUFZLEdBQThCLElBQTlCLFNBQUVDLEVBQUYsZUFBWXVCLEdBQWtCLEVBQ3hDQyxNQUFNeEIsR0FDTkMsS0FBSzZCLFdBQWE3QixLQUFLRSxPQUFPRSxjQUFjLHVCQUM1Q0osS0FBSzhCLGFBQWU5QixLQUFLNkIsV0FBV0UsWUFDcEMvQixLQUFLZ0MsZ0JBQWtCVixDQUN4QixDQUVEaUgsVUFBVWtCLEdBQ1J6SixLQUFLd0IsY0FBZ0JpSSxDQUN0QixDQUVENUcsY0FDRTdDLEtBQUs2QixXQUFXRSxZQUFjL0IsS0FBS2dDLGVBQ3BDLENBRURjLGNBQ0U5QyxLQUFLNkIsV0FBV0UsWUFBYy9CLEtBQUs4QixZQUNwQyxDQUVEbkIsb0JBQ0VYLEtBQUtFLE9BQ0ZFLGNBQWMsdUJBQ2RRLGlCQUFpQixXQUFZSixJQUM1QlIsS0FBS3dCLGNBQWNoQixFQUFuQixJQUVKZSxNQUFNWixtQkFDUCxHSjZGdUMsQ0FDeENaLFNBQVUsY0FDVnVCLGVBQWdCLGdCQUVsQmdILEVBQWEzSCxvQkFFYixNQUFNd0gsRUFBVyxJS2hJRixNQUNickksWUFBWXlDLEdBQ1Z2QyxLQUFLMEosY0FBZ0JuSCxFQUFLb0gsYUFDMUIzSixLQUFLNEosYUFBZXJILEVBQUtzSCxZQUN6QjdKLEtBQUs4SixVQUFZM0osU0FBU0MsY0FBVCxVQUEwQkosS0FBSzBKLGdCQUNoRDFKLEtBQUsrSixTQUFXNUosU0FBU0MsY0FBVCxVQUEwQkosS0FBSzRKLGVBQy9DNUosS0FBS2dLLGFBQWU3SixTQUFTQyxjQUFjLG9CQUM1QyxDQUVEMkQsY0FJRSxPQUhBL0QsS0FBS21HLE1BQVFuRyxLQUFLOEosVUFBVS9ILFlBQzVCL0IsS0FBS2lLLEtBQU9qSyxLQUFLK0osU0FBU2hJLFlBRW5CLENBQUVxRSxLQUFNcEcsS0FBS21HLE1BQU8rRCxNQUFPbEssS0FBS2lLLEtBQ3hDLENBRURkLFlBQVlnQixHQUNWbkssS0FBSzhKLFVBQVUvSCxZQUFjb0ksRUFBUS9ELEtBQ3JDcEcsS0FBSytKLFNBQVNoSSxZQUFjb0ksRUFBUUQsS0FDckMsQ0FFREUsY0FBY3RGLEdBQ1o5RSxLQUFLZ0ssYUFBYW5DLElBQU0vQyxDQUN6QixDQUVEc0QsWUFDRSxPQUFPcEksS0FBS3lHLEdBQ2IsQ0FFRDRELFVBQVVoSSxHQUNSckMsS0FBS3lHLElBQU1wRSxDQUNaLEdMaUcyQixDQUM1QnNILGFBQWMsc0JBQ2RFLFlBQWEseUJBR1RTLEVBQWlCLENBQUMsRUFDRUMsUUZsSVQsQ0FDZkMsYUFBYyxlQUNkQyxjQUFlLHFCQUNmQyxxQkFBc0Isc0JBQ3RCQyxvQkFBcUIsR0FDckJDLGdCQUFpQiwwQkFDakJDLFdBQVksa0NFNkhLQyxNQUFNQyxLQUFLNUssU0FBU3lCLGlCQUFpQjJJLEVBQVNDLGVBQ3REckksU0FBUzZJLElBQ2hCLE1BQU1DLEVBQVksSU16SXRCLE1BQ0VuTCxZQUFZeUssRUFBVVMsR0FBYSwyQkE4QmZFLElBQ2RBLEVBQWFDLFNBQVNDLE1BQ3hCcEwsS0FBS3FMLGdCQUFnQkgsR0FFckJsTCxLQUFLc0wsZ0JBQWdCSixFQUFjQSxFQUFhSyxrQkFDakQsSUFuQ2dDLDBCQXNDakIsQ0FBQ0wsRUFBY00sS0FDL0IsTUFBTUMsRUFBZXpMLEtBQUswTCxhQUFhdEwsY0FBbEIsV0FDZjhLLEVBQWFTLGFBQWEsVUFFaENULEVBQWFwSyxVQUFVRyxJQUFJakIsS0FBSzRMLFVBQVVoQixpQkFDMUNhLEVBQWExSixZQUFjeUosRUFDM0JDLEVBQWEzSyxVQUFVSyxPQUFPbkIsS0FBSzRMLFVBQVVmLFdBQTdDLElBNUNpQywwQkErQ2hCSyxJQUNqQixNQUFNTyxFQUFlekwsS0FBSzBMLGFBQWF0TCxjQUFsQixXQUNmOEssRUFBYVMsYUFBYSxVQUVoQ1QsRUFBYXBLLFVBQVVLLE9BQU9uQixLQUFLNEwsVUFBVWhCLGlCQUM3Q2EsRUFBYTNLLFVBQVVHLElBQUlqQixLQUFLNEwsVUFBVWYsWUFDMUNZLEVBQWExSixZQUFjLEVBQTNCLElBckRpQywyQkF3RGY4SixHQUNYQSxFQUFVM0QsTUFBTWdELElBQ2JBLEVBQWFDLFNBQVNDLFVBekRoQ3BMLEtBQUs0TCxVQUFZckIsRUFDakJ2SyxLQUFLMEwsYUFBZVYsRUFDcEJoTCxLQUFLOEwsV0FBYWhCLE1BQU1DLEtBQ3RCL0ssS0FBSzBMLGFBQWE5SixpQkFBaUI1QixLQUFLNEwsVUFBVW5CLGdCQUVwRHpLLEtBQUsrTCxZQUFjL0wsS0FBSzBMLGFBQWF0TCxjQUNuQ0osS0FBSzRMLFVBQVVsQixxQkFFbEIsQ0FFRHNCLGtCQUNFaE0sS0FBS2lNLGtCQUNMak0sS0FBSzhMLFdBQVczSixTQUFTK0ksSUFDdkJsTCxLQUFLcUwsZ0JBQWdCSCxFQUFyQixHQUVILENBRURnQixtQkFDRWxNLEtBQUtpTSxrQkFDTGpNLEtBQUtnTSxrQkFFTGhNLEtBQUs4TCxXQUFXM0osU0FBUytJLElBQ3ZCQSxFQUFhdEssaUJBQWlCLFNBQVMsS0FDckNaLEtBQUttTSxpQkFBaUJqQixHQUN0QmxMLEtBQUtpTSxpQkFBTCxHQUZGLEdBS0gsQ0FrQ0RBLGtCQUNNak0sS0FBS29NLGlCQUFpQnBNLEtBQUs4TCxZQUM3QjlMLEtBQUsrTCxZQUFZckUsYUFBYSxZQUFZLEdBRTFDMUgsS0FBSytMLFlBQVlNLGdCQUFnQixXQUVwQyxHTm9FcUM5QixFQUFVUyxHQUV4Q3NCLEVBQVd0QixFQUFZVyxhQUFhLFFBRTFDckIsRUFBZWdDLEdBQVlyQixFQUMzQkEsRUFBVWlCLGtCQUFWLElBTUo5SSxFQUFJMkIsaUJBQWlCZCxNQUFLLElBQTRCLElBQTFCc0ksRUFBVUMsR0FBZ0IsRUFDcERyRSxFQUFTZ0IsWUFBWW9ELEdBQ3JCcEUsRUFBU2lDLGNBQWNtQyxFQUFTekgsUUFDaENxRCxFQUFTa0MsVUFBVWtDLEVBQVM5RixLQUM1QnZCLEVBQWVVLFVBQVU0RyxFQUF6QixJQUdGckosRUFBa0J2QyxpQkFBaUIsU0FNbkMsV0FDRXFJLEVBQW9CakksTUFDckIsSUFORGlDLEVBQWVyQyxpQkFBaUIsU0FRaEMsV0FDRSxNQUFNMkIsRUFBTzRGLEVBQVNwRSxjQUN0QnFGLEVBQVlwSSxLQUFLdUIsR0FDakIrSCxFQUFjLGdCQUFvQjBCLGlCQUNuQyxJQVZEOUksRUFBV3RDLGlCQUFpQixTQVk1QixXQUNFMEosRUFBYyxZQUFnQjBCLGtCQUM5QjNDLEVBQWFySSxNQUNkLEciLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL3NjcmlwdHMvY29tcG9uZW50cy9Qb3B1cC5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL3NjcmlwdHMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvc2NyaXB0cy91dGlscy9jb25zdGFudHMuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9zY3JpcHRzL3V0aWxzL0FwaS5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL3BhZ2UvaW5kZXguanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9zY3JpcHRzL2NvbXBvbmVudHMvU2VjdGlvbi5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL3NjcmlwdHMvY29tcG9uZW50cy9DYXJkLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvc2NyaXB0cy9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvc2NyaXB0cy9jb21wb25lbnRzL1dhcm5Qb3B1cC5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL3NjcmlwdHMvY29tcG9uZW50cy9Vc2VySW5mby5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL3NjcmlwdHMvY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNvbnN0IFBPUFVQX0FDVElWRV9DTEFTUyA9IFwicG9wdXBfYWN0aXZlXCI7XHJcbmNvbnN0IFBPUFVQX0NMT1NFX0JUTl9TRUxFQ1RPUiA9IFwicG9wdXBfX2NvbnRhaW5lci1jbG9zZVwiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHNlbGVjdG9yKSB7XHJcbiAgICB0aGlzLl9zZWxlY3RvciA9IHNlbGVjdG9yO1xyXG4gICAgdGhpcy5fbW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAke3RoaXMuX3NlbGVjdG9yfWApO1xyXG4gICAgdGhpcy5faGFuZGxlRXNjS2V5ID0gdGhpcy5faGFuZGxlRXNjS2V5LmJpbmQodGhpcyk7XHJcbiAgICB0aGlzLl9oYW5kbGVDbG9zZVBvcHVwID0gdGhpcy5faGFuZGxlQ2xvc2VQb3B1cC5iaW5kKHRoaXMpO1xyXG4gIH1cclxuXHJcbiAgX2hhbmRsZUVzY0tleShldnQpIHtcclxuICAgIGlmIChldnQua2V5ID09PSBcIkVzY2FwZVwiKSB7XHJcbiAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5fbW9kYWwuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNldXBcIiwgdGhpcy5faGFuZGxlQ2xvc2VQb3B1cCk7XHJcbiAgfVxyXG5cclxuICBfaGFuZGxlQ2xvc2VQb3B1cChldnQpIHtcclxuICAgIGlmIChldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhQT1BVUF9BQ1RJVkVfQ0xBU1MpKSB7XHJcbiAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgIH1cclxuICAgIGlmIChldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhQT1BVUF9DTE9TRV9CVE5fU0VMRUNUT1IpKSB7XHJcbiAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIG9wZW4oKSB7XHJcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5dXBcIiwgdGhpcy5faGFuZGxlRXNjS2V5KTtcclxuICAgIHRoaXMuX21vZGFsLmNsYXNzTGlzdC5hZGQoUE9QVVBfQUNUSVZFX0NMQVNTKTtcclxuICB9XHJcblxyXG4gIGNsb3NlKCkge1xyXG4gICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleXVwXCIsIHRoaXMuX2hhbmRsZUVzY0tleSk7XHJcbiAgICB0aGlzLl9tb2RhbC5jbGFzc0xpc3QucmVtb3ZlKFBPUFVQX0FDVElWRV9DTEFTUyk7XHJcbiAgfVxyXG4gIFxyXG59XHJcbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xyXG5cclxuY29uc3QgRk9STV9TRUxFQ1RPUiA9IFwiLnBvcHVwX19mb3JtXCI7XHJcbmNvbnN0IEZPUk1fSU5QVVRfRklFTERfU0VMRUNUT1IgPSBcIi5wb3B1cF9fZm9ybS1maWVsZFwiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoRm9ybSBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcih7IHNlbGVjdG9yLCBoYW5kbGVTdWJtaXQsIGxvYWRpbmdCdG5UZXh0IH0pIHtcclxuICAgIHN1cGVyKHNlbGVjdG9yKTtcclxuICAgIHRoaXMuX2hhbmRsZVN1Ym1pdCA9IGhhbmRsZVN1Ym1pdDtcclxuICAgIHRoaXMuX2hhbmRsZVN1Ym1pdCA9IHRoaXMuX2hhbmRsZVN1Ym1pdC5iaW5kKHRoaXMpO1xyXG4gICAgdGhpcy5faGFuZGxlcldpdGhGb3JtID0gdGhpcy5faGFuZGxlcldpdGhGb3JtLmJpbmQodGhpcyk7XHJcbiAgICB0aGlzLl9mb3JtID0gdGhpcy5fbW9kYWwucXVlcnlTZWxlY3RvcihGT1JNX1NFTEVDVE9SKTtcclxuICAgIHRoaXMuX2lucHV0RmllbGRzID0gW1xyXG4gICAgICAuLi50aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3JBbGwoRk9STV9JTlBVVF9GSUVMRF9TRUxFQ1RPUiksXHJcbiAgICBdO1xyXG4gICAgdGhpcy5fc3VibWl0QnRuID0gdGhpcy5fbW9kYWwucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fZm9ybS1zdWJtaXRcIik7XHJcbiAgICB0aGlzLl9idG5Jbml0VGV4dCA9IHRoaXMuX3N1Ym1pdEJ0bi50ZXh0Q29udGVudDtcclxuICAgIHRoaXMuX2xvYWRpbmdCdG5UZXh0ID0gbG9hZGluZ0J0blRleHQ7XHJcbiAgfVxyXG5cclxuICBfZ2V0SW5wdXRWYWx1ZXMoKSB7XHJcbiAgICBjb25zdCBpbnB1dFZhbHVlcyA9IHt9O1xyXG4gICAgdGhpcy5faW5wdXRGaWVsZHMuZm9yRWFjaCgoZmllbGQpID0+IHtcclxuICAgICAgaW5wdXRWYWx1ZXNbZmllbGQuaWRdID0gZmllbGQudmFsdWU7XHJcbiAgICB9KTtcclxuICAgIHJldHVybiBpbnB1dFZhbHVlcztcclxuICB9XHJcblxyXG4gIG9wZW4oZGF0YSkge1xyXG4gICAgaWYgKGRhdGEpIHRoaXMuX3NldElucHV0VmFsdWVzKGRhdGEpO1xyXG4gICAgc3VwZXIub3BlbigpO1xyXG4gIH1cclxuXHJcbiAgX3NldElucHV0VmFsdWVzKHZhbHVlcykge1xyXG4gICAgdGhpcy5faW5wdXRGaWVsZHMuZm9yRWFjaCgoZmllbGQpID0+IHtcclxuICAgICAgT2JqZWN0LmtleXModmFsdWVzKS5mb3JFYWNoKChrZXkpID0+IHtcclxuICAgICAgICBpZiAoZmllbGQuaWQgPT09IGtleSkge1xyXG4gICAgICAgICAgZmllbGQudmFsdWUgPSB2YWx1ZXNba2V5XTtcclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBfaGFuZGxlcldpdGhGb3JtKGV2dCkge1xyXG4gICAge1xyXG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgdGhpcy5faGFuZGxlU3VibWl0KHRoaXMuX2dldElucHV0VmFsdWVzKCkpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgc2hvd0xvYWRpbmcoKSB7XHJcbiAgICB0aGlzLl9zdWJtaXRCdG4udGV4dENvbnRlbnQgPSB0aGlzLl9sb2FkaW5nQnRuVGV4dDtcclxuICB9XHJcblxyXG4gIGhpZGVMb2FkaW5nKCkge1xyXG4gICAgdGhpcy5fc3VibWl0QnRuLnRleHRDb250ZW50ID0gdGhpcy5fYnRuSW5pdFRleHQ7XHJcbiAgfVxyXG5cclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHRoaXMuX2Zvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCB0aGlzLl9oYW5kbGVyV2l0aEZvcm0pO1xyXG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICB9XHJcblxyXG4gIGNsb3NlKCkge1xyXG4gICAgc3VwZXIuY2xvc2UoKTtcclxuICAgIHNldFRpbWVvdXQoKCkgPT4gdGhpcy5fZm9ybS5yZXNldCgpLCA1MDApO1xyXG4gIH1cclxufVxyXG4iLCJjb25zdCBUT0tFTiA9IFwiYTcxZDEwYTgtYzNlNC00YTQzLWJiYmMtZGI4MWU0ODhhYjIwXCI7XHJcbmNvbnN0IGJ0bkVkaXRQcm9maWxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19lZGl0LWJ1dHRvblwiKTtcclxuY29uc3QgYnRuQWRkQ2FyZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYWRkLWJ0blwiKTtcclxuY29uc3QgYnRuUHJvZmlsZVBpY3R1cmUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX3BpY3R1cmUtYnV0dG9uXCIpO1xyXG5jb25zdCBzZXR0aW5ncyA9IHtcclxuICBmb3JtU2VsZWN0b3I6IFwiLnBvcHVwX19mb3JtXCIsXHJcbiAgaW5wdXRTZWxlY3RvcjogXCIucG9wdXBfX2Zvcm0tZmllbGRcIixcclxuICBzdWJtaXRCdXR0b25TZWxlY3RvcjogXCIucG9wdXBfX2Zvcm0tc3VibWl0XCIsXHJcbiAgaW5hY3RpdmVCdXR0b25DbGFzczogXCJcIixcclxuICBpbnB1dEVycm9yQ2xhc3M6IFwicG9wdXBfX2Zvcm0tZmllbGRfZXJyb3JcIixcclxuICBlcnJvckNsYXNzOiBcInBvcHVwX19mb3JtLWVycm9yLW1zZ19pbmFjdGl2ZVwiLFxyXG59O1xyXG5cclxuZXhwb3J0IHsgYnRuRWRpdFByb2ZpbGUsIGJ0bkFkZENhcmQsIHNldHRpbmdzLCBUT0tFTiwgYnRuUHJvZmlsZVBpY3R1cmUgfTtcclxuIiwiaW1wb3J0IHsgVE9LRU4gfSBmcm9tIFwiLi9jb25zdGFudHMuanNcIjtcclxuXHJcbmNsYXNzIEFwaSB7XHJcbiAgY29uc3RydWN0b3IoeyBiYXNlVVJMLCBoZWFkZXJzIH0pIHtcclxuICAgIHRoaXMuX2Jhc2VVUkwgPSBiYXNlVVJMO1xyXG4gICAgdGhpcy5faGVhZGVycyA9IGhlYWRlcnM7XHJcbiAgfVxyXG5cclxuICBfcHJvY2Vzc1Jlc3BvbnNlID0gKHJlcykgPT4ge1xyXG4gICAgcmV0dXJuIHJlcy5vayA/IHJlcy5qc29uKCkgOiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c1RleHR9YCk7XHJcbiAgfTtcclxuXHJcbiAgZ2V0VXNlckluZm8oKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVSTH0vdXNlcnMvbWVgLCB7IGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMgfSkudGhlbihcclxuICAgICAgIHRoaXMuX3Byb2Nlc3NSZXNwb25zZVxyXG4gICAgKTtcclxuICB9XHJcblxyXG4gIGdldEluaXRpYWxDYXJkcygpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVVJMfS9jYXJkc2AsIHsgaGVhZGVyczogdGhpcy5faGVhZGVycyB9KS50aGVuKFxyXG4gICAgICAocmVzKSA9PiB0aGlzLl9wcm9jZXNzUmVzcG9uc2UocmVzKVxyXG4gICAgKTtcclxuICB9XHJcblxyXG4gIHBhdGNoVXNlckluZm8oZGF0YSkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVUkx9dXNlcnMvbWVgLCB7XHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeShkYXRhKSxcclxuICAgIH0pLnRoZW4oKHJlcykgPT4gdGhpcy5fcHJvY2Vzc1Jlc3BvbnNlKHJlcykpO1xyXG4gIH1cclxuXHJcbiAgcG9zdE5ld0NhcmQoZGF0YSkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVUkx9L2NhcmRzYCwge1xyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICBtZXRob2Q6IFwiUE9TVFwiLFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeShkYXRhKSxcclxuICAgIH0pLnRoZW4oKHJlcykgPT4gdGhpcy5fcHJvY2Vzc1Jlc3BvbnNlKHJlcykpO1xyXG4gIH1cclxuXHJcbiAgZGVsZXRlQ2FyZChpZCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVUkx9L2NhcmRzLyR7aWR9YCwge1xyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXHJcbiAgICB9KS50aGVuKChyZXMpID0+IHRoaXMuX3Byb2Nlc3NSZXNwb25zZShyZXMpKTtcclxuICB9XHJcblxyXG4gIGFkZExpa2UoaWQpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVVJMfWNhcmRzL2xpa2VzLyR7aWR9YCwge1xyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICBtZXRob2Q6IFwiUFVUXCIsXHJcbiAgICB9KS50aGVuKChyZXMpID0+IHRoaXMuX3Byb2Nlc3NSZXNwb25zZShyZXMpKTtcclxuICB9XHJcblxyXG4gIHJlbW92ZUxpa2UoaWQpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVVJMfWNhcmRzL2xpa2VzLyR7aWR9YCwge1xyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXHJcbiAgICB9KS50aGVuKChyZXMpID0+IHRoaXMuX3Byb2Nlc3NSZXNwb25zZShyZXMpKTtcclxuICB9XHJcblxyXG4gIGNoYW5nZUF2YXRhcihhdmF0YXIpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVVJMfXVzZXJzL21lL2F2YXRhcmAsIHtcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHsgYXZhdGFyIH0pLFxyXG4gICAgfSkudGhlbigocmVzKSA9PiB0aGlzLl9wcm9jZXNzUmVzcG9uc2UocmVzKSk7XHJcbiAgfVxyXG5cclxuICBnZXRJbml0aWFsRGF0YSgpIHtcclxuICAgIHJldHVybiBQcm9taXNlLmFsbChbYXBpLmdldFVzZXJJbmZvKCksIGFwaS5nZXRJbml0aWFsQ2FyZHMoKV0pO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGNvbnN0IGFwaSA9IG5ldyBBcGkoe1xyXG4gIGJhc2VVUkw6IFwiaHR0cHM6Ly9hcm91bmQubm9tb3JlcGFydGllcy5jby92MS9jb2hvcnQtMy1lbi9cIixcclxuICBoZWFkZXJzOiB7XHJcbiAgICBhdXRob3JpemF0aW9uOiBgJHtUT0tFTn1gLFxyXG4gICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXHJcbiAgfSxcclxufSk7XHJcbiIsImltcG9ydCBcIi4vaW5kZXguY3NzXCI7XHJcbmltcG9ydCBGb3JtVmFsaWRhdG9yIGZyb20gXCIuLi9zY3JpcHRzL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qc1wiO1xyXG5pbXBvcnQgQ2FyZCBmcm9tIFwiLi4vc2NyaXB0cy9jb21wb25lbnRzL0NhcmQuanNcIjtcclxuaW1wb3J0IFNlY3Rpb24gZnJvbSBcIi4uL3NjcmlwdHMvY29tcG9uZW50cy9TZWN0aW9uLmpzXCI7XHJcbmltcG9ydCBQb3B1cFdpdGhJbWFnZSBmcm9tIFwiLi4vc2NyaXB0cy9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzXCI7XHJcbmltcG9ydCBVc2VySW5mbyBmcm9tIFwiLi4vc2NyaXB0cy9jb21wb25lbnRzL1VzZXJJbmZvLmpzXCI7XHJcbmltcG9ydCBQb3B1cFdpdGhGb3JtIGZyb20gXCIuLi9zY3JpcHRzL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qc1wiO1xyXG5pbXBvcnQge1xyXG4gIGJ0bkVkaXRQcm9maWxlLFxyXG4gIGJ0bkFkZENhcmQsXHJcbiAgYnRuUHJvZmlsZVBpY3R1cmUsXHJcbiAgc2V0dGluZ3MsXHJcbn0gZnJvbSBcIi4uL3NjcmlwdHMvdXRpbHMvY29uc3RhbnRzLmpzXCI7XHJcbmltcG9ydCB7IGFwaSB9IGZyb20gXCIuLi9zY3JpcHRzL3V0aWxzL0FwaS5qc1wiO1xyXG5pbXBvcnQgeyBXYXJuUG9wdXAgfSBmcm9tIFwiLi4vc2NyaXB0cy9jb21wb25lbnRzL1dhcm5Qb3B1cFwiO1xyXG5cclxuZnVuY3Rpb24gY3JlYXRlQ2FyZChjYXJkKSB7XHJcbiAgY29uc3QgY2FyZEVsZW1lbnQgPSBuZXcgQ2FyZChcclxuICAgIHtcclxuICAgICAgZGF0YTogY2FyZCxcclxuICAgICAgdXNlcklkOiB1c2VySW5mby5nZXRVc2VySWQoKSxcclxuICAgICAgaGFuZGxlSW1nOiAoY2FyZCkgPT4ge1xyXG4gICAgICAgIHBvcHVwSW1nLm9wZW4oY2FyZCk7XHJcbiAgICAgIH0sXHJcbiAgICAgIGhhbmRsZURlbDogKGlkKSA9PiB7XHJcbiAgICAgICAgZGVsV2FyblBvcHVwLm9wZW4oKTtcclxuICAgICAgICBkZWxXYXJuUG9wdXAuc2V0QWN0aW9uKCgpID0+IHtcclxuICAgICAgICAgIGRlbFdhcm5Qb3B1cC5zaG93TG9hZGluZygpO1xyXG4gICAgICAgICAgYXBpXHJcbiAgICAgICAgICAgIC5kZWxldGVDYXJkKGlkKVxyXG4gICAgICAgICAgICAudGhlbigoKSA9PiB7XHJcbiAgICAgICAgICAgICAgY2FyZEVsZW1lbnQucmVtb3ZlKCk7XHJcbiAgICAgICAgICAgICAgZGVsV2FyblBvcHVwLmNsb3NlKCk7XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmxvZyhlcnIpKVxyXG4gICAgICAgICAgICAuZmluYWxseSgoKSA9PiBkZWxXYXJuUG9wdXAuaGlkZUxvYWRpbmcoKSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH0sXHJcbiAgICAgIGhhbmRsZUxpa2U6ICgpID0+IHtcclxuICAgICAgICBpZiAoY2FyZEVsZW1lbnQuX2lzTGlrZWQoKSkge1xyXG4gICAgICAgICAgYXBpXHJcbiAgICAgICAgICAgIC5yZW1vdmVMaWtlKGNhcmRFbGVtZW50Ll9pZClcclxuICAgICAgICAgICAgLnRoZW4oKHJlc3BvbnNlKSA9PiB7XHJcbiAgICAgICAgICAgICAgY2FyZEVsZW1lbnQuX3VwZGF0ZUxpa2VzKHJlc3BvbnNlLmxpa2VzKTtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLmNhdGNoKGNvbnNvbGUuZXJyb3IpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICBhcGlcclxuICAgICAgICAgICAgLmFkZExpa2UoY2FyZEVsZW1lbnQuX2lkKVxyXG4gICAgICAgICAgICAudGhlbigocmVzcG9uc2UpID0+IHtcclxuICAgICAgICAgICAgICBjYXJkRWxlbWVudC5fdXBkYXRlTGlrZXMocmVzcG9uc2UubGlrZXMpO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAuY2F0Y2goY29uc29sZS5lcnJvcik7XHJcbiAgICAgICAgfVxyXG4gICAgICB9LFxyXG4gICAgfSxcclxuICAgIFwiI2NhcmRcIlxyXG4gICk7XHJcbiAgcmV0dXJuIGNhcmRFbGVtZW50Lm1ha2VDYXJkKCk7XHJcbn1cclxuXHJcbmNvbnN0IGdhbGxlcnlTZWN0aW9uID0gbmV3IFNlY3Rpb24oe1xyXG4gIHJlbmRlcmVyOiBjcmVhdGVDYXJkLFxyXG4gIHNlbGVjdG9yOiBcIi5nYWxsZXJ5XCIsXHJcbn0pO1xyXG5cclxuY29uc3QgcG9wdXBJbWcgPSBuZXcgUG9wdXBXaXRoSW1hZ2UoXCIjaW1nUG9wdXBcIik7XHJcbnBvcHVwSW1nLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG5leHBvcnQgY29uc3QgcHJvZmlsZVBpY3R1cmVQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKHtcclxuICBzZWxlY3RvcjogXCIjYXZhdGFyXCIsXHJcbiAgaGFuZGxlU3VibWl0OiAobGluaykgPT4ge1xyXG4gICAgcHJvZmlsZVBpY3R1cmVQb3B1cC5zaG93TG9hZGluZygpO1xyXG4gICAgYXBpXHJcbiAgICAgIC5jaGFuZ2VBdmF0YXIobGluay5hdmF0YXJMaW5rKVxyXG4gICAgICAudGhlbigocmVzKSA9PiB7XHJcbiAgICAgICAgdXNlckluZm8uc2V0VXNlckluZm8ocmVzKTtcclxuICAgICAgICBwcm9maWxlUGljdHVyZVBvcHVwLmNsb3NlKCk7XHJcbiAgICAgIH0pXHJcbiAgICAgIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmxvZyhlcnIpKVxyXG4gICAgICAuZmluYWxseSgoKSA9PiAgcHJvZmlsZVBpY3R1cmVQb3B1cC5oaWRlTG9hZGluZygpKTtcclxuICB9LFxyXG4gIGxvYWRpbmdCdG5UZXh0OiBcIlNhdmluZy4uLlwiLFxyXG59KTtcclxucHJvZmlsZVBpY3R1cmVQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuZXhwb3J0IGNvbnN0IGVkaXRQcm9maWxlID0gbmV3IFBvcHVwV2l0aEZvcm0oe1xyXG4gIHNlbGVjdG9yOiBcIiNwcm9maWxlUG9wdXBcIixcclxuICBoYW5kbGVTdWJtaXQ6IChkYXRhKSA9PiB7XHJcbiAgICBlZGl0UHJvZmlsZS5zaG93TG9hZGluZygpO1xyXG4gICAgYXBpXHJcbiAgICAgIC5wYXRjaFVzZXJJbmZvKGRhdGEpXHJcbiAgICAgIC50aGVuKChyZXMpID0+IHtcclxuICAgICAgICB1c2VySW5mby5zZXRVc2VySW5mbyhyZXMpO1xyXG4gICAgICAgIGVkaXRQcm9maWxlLmNsb3NlKCk7XHJcbiAgICAgIH0pXHJcbiAgICAgIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmxvZyhlcnIpKVxyXG5cclxuICAgICAgLmZpbmFsbHkoKCkgPT4gZWRpdFByb2ZpbGUuaGlkZUxvYWRpbmcoKSk7XHJcbiAgfSxcclxuICBsb2FkaW5nQnRuVGV4dDogXCJTYXZpbmcuLi5cIixcclxufSk7XHJcbmVkaXRQcm9maWxlLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG5leHBvcnQgY29uc3QgYWRkQ2FyZFBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oe1xyXG4gIHNlbGVjdG9yOiBcIiNhZGRDYXJkUG9wdXBcIixcclxuICBoYW5kbGVTdWJtaXQ6IChkYXRhKSA9PiB7XHJcbiAgICBhZGRDYXJkUG9wdXAuc2hvd0xvYWRpbmcoKTtcclxuICAgIGFwaVxyXG4gICAgICAucG9zdE5ld0NhcmQoeyBuYW1lOiBkYXRhLnRpdGxlLCBsaW5rOiBkYXRhLmltZ0xpbmsgfSlcclxuICAgICAgLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICAgIGdhbGxlcnlTZWN0aW9uLmFkZEl0ZW0ocmVzKTtcclxuICAgICAgICBhZGRDYXJkUG9wdXAuY2xvc2UoKTtcclxuICAgICAgfSlcclxuICAgICAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUubG9nKGVycikpXHJcblxyXG4gICAgICAuZmluYWxseSgoKSA9PiAgYWRkQ2FyZC5oaWRlTG9hZGluZygpKTtcclxuICB9LFxyXG4gIGxvYWRpbmdCdG5UZXh0OiBcIlNhdmluZy4uLlwiLFxyXG59KTtcclxuYWRkQ2FyZFBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG5leHBvcnQgY29uc3QgZGVsV2FyblBvcHVwID0gbmV3IFdhcm5Qb3B1cCh7XHJcbiAgc2VsZWN0b3I6IFwiI2NhcmREZWxldGVcIixcclxuICBsb2FkaW5nQnRuVGV4dDogXCJEZWxldGluZy4uLlwiLFxyXG59KTtcclxuZGVsV2FyblBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG5jb25zdCB1c2VySW5mbyA9IG5ldyBVc2VySW5mbyh7XHJcbiAgbmFtZVNlbGVjdG9yOiBcIi5wcm9maWxlX191c2VyLW5hbWVcIixcclxuICBqb2JTZWxlY3RvcjogXCIucHJvZmlsZV9fdXNlci1hYm91dFwiLFxyXG59KTtcclxuXHJcbmNvbnN0IGZvcm1WYWxpZGF0b3JzID0ge307XHJcbmNvbnN0IGVuYWJsZVZhbGlkYXRpb24gPSAoc2V0dGluZ3MpID0+IHtcclxuICBjb25zdCBmb3JtTGlzdCA9IEFycmF5LmZyb20oZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChzZXR0aW5ncy5mb3JtU2VsZWN0b3IpKTtcclxuICBmb3JtTGlzdC5mb3JFYWNoKChmb3JtRWxlbWVudCkgPT4ge1xyXG4gICAgY29uc3QgdmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3Ioc2V0dGluZ3MsIGZvcm1FbGVtZW50KTtcclxuXHJcbiAgICBjb25zdCBmb3JtTmFtZSA9IGZvcm1FbGVtZW50LmdldEF0dHJpYnV0ZShcIm5hbWVcIik7XHJcblxyXG4gICAgZm9ybVZhbGlkYXRvcnNbZm9ybU5hbWVdID0gdmFsaWRhdG9yO1xyXG4gICAgdmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcclxuICB9KTtcclxufTtcclxuXHJcbmVuYWJsZVZhbGlkYXRpb24oc2V0dGluZ3MpO1xyXG5cclxuYXBpLmdldEluaXRpYWxEYXRhKCkudGhlbigoW3VzZXJEYXRhLCBjYXJkc0FycmF5XSkgPT4ge1xyXG4gIHVzZXJJbmZvLnNldFVzZXJJbmZvKHVzZXJEYXRhKTtcclxuICB1c2VySW5mby5zZXRVc2VyQXZhdGFyKHVzZXJEYXRhLmF2YXRhcik7XHJcbiAgdXNlckluZm8uc2V0VXNlcklkKHVzZXJEYXRhLl9pZCk7XHJcbiAgZ2FsbGVyeVNlY3Rpb24ucmVuZGVyQWxsKGNhcmRzQXJyYXkpO1xyXG59KTtcclxuXHJcbmJ0blByb2ZpbGVQaWN0dXJlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBoYW5kbGVQcm9maWxlUGljdHVyZSk7XHJcblxyXG5idG5FZGl0UHJvZmlsZS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgaGFuZGxlRWRpdFByb2ZpbGVCdG4pO1xyXG5cclxuYnRuQWRkQ2FyZC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgaGFuZGxlQWRkQ2FyZCk7XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVQcm9maWxlUGljdHVyZSgpIHtcclxuICBwcm9maWxlUGljdHVyZVBvcHVwLm9wZW4oKTtcclxufVxyXG5cclxuZnVuY3Rpb24gaGFuZGxlRWRpdFByb2ZpbGVCdG4oKSB7XHJcbiAgY29uc3QgZGF0YSA9IHVzZXJJbmZvLmdldFVzZXJJbmZvKCk7XHJcbiAgZWRpdFByb2ZpbGUub3BlbihkYXRhKTtcclxuICBmb3JtVmFsaWRhdG9yc1tcImVkaXRQcm9maWxlRm9ybVwiXS5yZXNldFZhbGlkYXRpb24oKTtcclxufVxyXG5cclxuZnVuY3Rpb24gaGFuZGxlQWRkQ2FyZCgpIHtcclxuICBmb3JtVmFsaWRhdG9yc1tcImFkZENhcmRGb3JtXCJdLnJlc2V0VmFsaWRhdGlvbigpO1xyXG4gIGFkZENhcmRQb3B1cC5vcGVuKCk7XHJcbn1cclxuXHJcbmV4cG9ydCB7IHVzZXJJbmZvLCBmb3JtVmFsaWRhdG9ycyB9O1xyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBTZWN0aW9uIHtcclxuICBjb25zdHJ1Y3Rvcih7IHJlbmRlcmVyLCBzZWxlY3RvciB9KSB7XHJcbiAgICB0aGlzLl9yZW5kZXJlciA9IHJlbmRlcmVyO1xyXG4gICAgdGhpcy5fY29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihzZWxlY3Rvcik7XHJcbiAgfVxyXG5cclxuICBhZGRJdGVtKGl0ZW0pIHtcclxuICAgIGNvbnN0IGNhcmQgPSB0aGlzLl9yZW5kZXJlcihpdGVtKTtcclxuICAgIHRoaXMuX2NvbnRhaW5lci5wcmVwZW5kKGNhcmQpO1xyXG4gIH1cclxuXHJcbiAgX2NsZWFyKCkge1xyXG4gICAgdGhpcy5fY29udGFpbmVyLmlubmVySFRNTCA9IFwiXCI7XHJcbiAgfVxyXG5cclxuICByZW5kZXJBbGwoaXRlbXMpIHtcclxuICAgIHRoaXMuX2NsZWFyKCk7XHJcbiAgICBpdGVtcy5mb3JFYWNoKChpdGVtKSA9PiB7XHJcbiAgICAgIHRoaXMuYWRkSXRlbShpdGVtKTtcclxuICAgIH0pO1xyXG4gIH1cclxufVxyXG4iLCJjbGFzcyBDYXJkIHtcclxuICBjb25zdHJ1Y3Rvcih7IGRhdGEsIGhhbmRsZUltZywgaGFuZGxlRGVsLCBoYW5kbGVMaWtlLCB1c2VySWQgfSwgc2VsZWN0b3IpIHtcclxuICAgIHRoaXMuX25hbWUgPSBkYXRhLm5hbWU7XHJcbiAgICB0aGlzLl9zcmMgPSBkYXRhLmxpbms7XHJcbiAgICB0aGlzLl9saWtlc0FyciA9IGRhdGEubGlrZXM7XHJcbiAgICB0aGlzLl9pZCA9IGRhdGEuX2lkO1xyXG4gICAgdGhpcy5vd25lcklkID0gZGF0YS5vd25lci5faWQ7XHJcbiAgICB0aGlzLl9zZWxlY3RvciA9IHNlbGVjdG9yO1xyXG4gICAgdGhpcy5faGFubGRlSW1nQ2xpY2sgPSBoYW5kbGVJbWc7XHJcbiAgICB0aGlzLl9oYW5kbGVEZWwgPSBoYW5kbGVEZWw7XHJcbiAgICB0aGlzLl9oYW5kbGVMaWtlQnRuID0gaGFuZGxlTGlrZTtcclxuICAgIHRoaXMuX3VzZXJJZCA9IHVzZXJJZDtcclxuICB9XHJcblxyXG4gIF9nZXRUZW1wbGF0ZSgpIHtcclxuICAgIGNvbnN0IGNhcmRFbGVtZW50ID0gZG9jdW1lbnRcclxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoYCR7dGhpcy5fc2VsZWN0b3J9YClcclxuICAgICAgLmNvbnRlbnQuY2xvbmVOb2RlKHRydWUpO1xyXG4gICAgcmV0dXJuIGNhcmRFbGVtZW50O1xyXG4gIH1cclxuXHJcbiAgbWFrZUNhcmQoKSB7XHJcbiAgICB0aGlzLl9lbGVtZW50ID0gdGhpcy5fZ2V0VGVtcGxhdGUoKS5xdWVyeVNlbGVjdG9yKFwiLmNhcmRcIik7XHJcbiAgICB0aGlzLl9pbWcgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9faW1nXCIpO1xyXG4gICAgdGhpcy5fY2FwdGlvbiA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19jYXB0aW9uXCIpO1xyXG4gICAgdGhpcy5fdHJhc2ggPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fdHJhc2hcIik7XHJcbiAgICB0aGlzLl9saWtlID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2xpa2UtYnRuXCIpO1xyXG4gICAgdGhpcy5fbGlrZXMgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fbGlrZS1jb3VudGVyXCIpO1xyXG4gICAgdGhpcy5faW1nLnNldEF0dHJpYnV0ZShcInNyY1wiLCB0aGlzLl9zcmMpO1xyXG4gICAgdGhpcy5faW1nLnNldEF0dHJpYnV0ZShcImFsdFwiLCB0aGlzLl9uYW1lKTtcclxuICAgIHRoaXMuX2NhcHRpb24udGV4dENvbnRlbnQgPSB0aGlzLl9uYW1lO1xyXG4gICAgdGhpcy5fdXBkYXRlTGlrZXModGhpcy5fbGlrZXNBcnIpO1xyXG4gICAgdGhpcy5fYWRkTGlzdGVuZXJzKCk7XHJcbiAgICBpZiAodGhpcy5fdXNlcklkICE9IHRoaXMub3duZXJJZCkge1xyXG4gICAgICB0aGlzLl90cmFzaC5jbGFzc0xpc3QuYWRkKFwidHJhc2hfZGlzcGxheS1ub25lXCIpO1xyXG4gICAgICB0aGlzLl90cmFzaC5zZXRBdHRyaWJ1dGUoXCJkaXNhYmxlZFwiLCBcIlwiKTtcclxuICAgIH1cclxuICAgIHRoaXMuX2VsZW1lbnQuc2V0QXR0cmlidXRlKFwiaWRcIiwgdGhpcy5faWQpO1xyXG4gICAgcmV0dXJuIHRoaXMuX2VsZW1lbnQ7XHJcbiAgfVxyXG5cclxuICBfYWRkTGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5fbGlrZS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4gdGhpcy5faGFuZGxlTGlrZUJ0bigpKTtcclxuICAgIHRoaXMuX2ltZy5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT5cclxuICAgICAgdGhpcy5faGFubGRlSW1nQ2xpY2soeyBuYW1lOiB0aGlzLl9uYW1lLCBzcmM6IHRoaXMuX3NyYyB9KVxyXG4gICAgKTtcclxuICAgIHRoaXMuX3RyYXNoLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB0aGlzLl9oYW5kbGVEZWwodGhpcy5faWQpKTtcclxuICB9XHJcblxyXG4gIF91cGRhdGVMaWtlcyhsaWtlcykge1xyXG4gICAgdGhpcy5fbGlrZXNBcnI9bGlrZXM7XHJcbiAgICB0aGlzLl9saWtlc0NvdW50ID0gbGlrZXMubGVuZ3RoO1xyXG4gICAgdGhpcy5fcmVuZGVyTGlrZXMoKTtcclxuICB9XHJcblxyXG4gIF9pc0xpa2VkKCkge1xyXG4gICAgcmV0dXJuIHRoaXMuX2xpa2VzQXJyLnNvbWUoKGl0ZW0pID0+IGl0ZW0uX2lkID09PSB0aGlzLl91c2VySWQpO1xyXG4gIH1cclxuXHJcbiAgX3JlbmRlckxpa2VzKCkge1xyXG4gICAgdGhpcy5fbGlrZXMudGV4dENvbnRlbnQgPSB0aGlzLl9saWtlc0NvdW50O1xyXG4gICAgaWYgKHRoaXMuX2lzTGlrZWQoKSkge1xyXG4gICAgICB0aGlzLl9saWtlLmNsYXNzTGlzdC5hZGQoXCJjYXJkX19saWtlLWJ0bl9hY3RpdmVcIik7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9saWtlLmNsYXNzTGlzdC5yZW1vdmUoXCJjYXJkX19saWtlLWJ0bl9hY3RpdmVcIik7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICByZW1vdmUoKSB7XHJcbiAgICB0aGlzLl9lbGVtZW50LnJlbW92ZSgpO1xyXG4gICAgdGhpcy5fZWxlbWVudCA9IG51bGw7XHJcbiAgfVxyXG59XHJcbmV4cG9ydCBkZWZhdWx0IENhcmQ7XHJcbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoSW1hZ2UgZXh0ZW5kcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3Ioc2VsZWN0b3IpIHtcclxuICAgIHN1cGVyKHNlbGVjdG9yKTtcclxuICAgIHRoaXMuX2ltYWdlID0gdGhpcy5fbW9kYWwucXVlcnlTZWxlY3RvcihcIi5pbWctcG9wb3V0X19pbWdcIik7XHJcbiAgICB0aGlzLl9jYXB0aW9uID0gdGhpcy5fbW9kYWwucXVlcnlTZWxlY3RvcihcIi5pbWctcG9wb3V0X19jYXB0aW9uXCIpO1xyXG4gIH1cclxuXHJcbiAgb3BlbihkYXRhKSB7XHJcbiAgICB0aGlzLl9pbWFnZS5zcmMgPSBkYXRhLnNyYztcclxuICAgIHRoaXMuX2ltYWdlLmFsdCA9IGRhdGEubmFtZTtcclxuICAgIHRoaXMuX2NhcHRpb24udGV4dENvbnRlbnQgPSBkYXRhLm5hbWU7XHJcbiAgICBzdXBlci5vcGVuKCk7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cFwiO1xyXG5cclxuZXhwb3J0IGNsYXNzIFdhcm5Qb3B1cCBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcih7IHNlbGVjdG9yLCBsb2FkaW5nQnRuVGV4dCB9KSB7XHJcbiAgICBzdXBlcihzZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9zdWJtaXRCdG4gPSB0aGlzLl9tb2RhbC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19mb3JtLXN1Ym1pdFwiKTtcclxuICAgIHRoaXMuX2J0bkluaXRUZXh0ID0gdGhpcy5fc3VibWl0QnRuLnRleHRDb250ZW50O1xyXG4gICAgdGhpcy5fbG9hZGluZ0J0blRleHQgPSBsb2FkaW5nQnRuVGV4dDtcclxuICB9XHJcblxyXG4gIHNldEFjdGlvbihhY3Rpb24pIHtcclxuICAgIHRoaXMuX2hhbmRsZVN1Ym1pdCA9IGFjdGlvbjtcclxuICB9XHJcblxyXG4gIHNob3dMb2FkaW5nKCkge1xyXG4gICAgdGhpcy5fc3VibWl0QnRuLnRleHRDb250ZW50ID0gdGhpcy5fbG9hZGluZ0J0blRleHQ7XHJcbiAgfVxyXG5cclxuICBoaWRlTG9hZGluZygpIHtcclxuICAgIHRoaXMuX3N1Ym1pdEJ0bi50ZXh0Q29udGVudCA9IHRoaXMuX2J0bkluaXRUZXh0O1xyXG4gIH1cclxuXHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICB0aGlzLl9tb2RhbFxyXG4gICAgICAucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fZm9ybS1zdWJtaXRcIilcclxuICAgICAgLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZXVwXCIsIChldnQpID0+IHtcclxuICAgICAgICB0aGlzLl9oYW5kbGVTdWJtaXQoZXZ0KTtcclxuICAgICAgfSk7XHJcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBVc2VySW5mbyB7XHJcbiAgY29uc3RydWN0b3IoZGF0YSkge1xyXG4gICAgdGhpcy5fbmFtZVNlbGVjdG9yID0gZGF0YS5uYW1lU2VsZWN0b3I7XHJcbiAgICB0aGlzLl9qb2JTZWxlY3RvciA9IGRhdGEuam9iU2VsZWN0b3I7XHJcbiAgICB0aGlzLl9uYW1lTm9kZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYCR7dGhpcy5fbmFtZVNlbGVjdG9yfWApO1xyXG4gICAgdGhpcy5fam9iTm9kZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYCR7dGhpcy5fam9iU2VsZWN0b3J9YCk7XHJcbiAgICB0aGlzLl9waWN0dXJlTm9kZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fcGljdHVyZVwiKTtcclxuICB9XHJcblxyXG4gIGdldFVzZXJJbmZvKCkge1xyXG4gICAgdGhpcy5fbmFtZSA9IHRoaXMuX25hbWVOb2RlLnRleHRDb250ZW50O1xyXG4gICAgdGhpcy5fam9iID0gdGhpcy5fam9iTm9kZS50ZXh0Q29udGVudDtcclxuXHJcbiAgICByZXR1cm4geyBuYW1lOiB0aGlzLl9uYW1lLCBhYm91dDogdGhpcy5fam9iIH07XHJcbiAgfVxyXG5cclxuICBzZXRVc2VySW5mbyhuZXdEYXRhKSB7XHJcbiAgICB0aGlzLl9uYW1lTm9kZS50ZXh0Q29udGVudCA9IG5ld0RhdGEubmFtZTtcclxuICAgIHRoaXMuX2pvYk5vZGUudGV4dENvbnRlbnQgPSBuZXdEYXRhLmFib3V0O1xyXG4gIH1cclxuXHJcbiAgc2V0VXNlckF2YXRhcihhdmF0YXIpIHtcclxuICAgIHRoaXMuX3BpY3R1cmVOb2RlLnNyYyA9IGF2YXRhcjtcclxuICB9XHJcblxyXG4gIGdldFVzZXJJZCgpIHtcclxuICAgIHJldHVybiB0aGlzLl9pZDtcclxuICB9XHJcblxyXG4gIHNldFVzZXJJZChpZCkge1xyXG4gICAgdGhpcy5faWQgPSBpZDtcclxuICB9XHJcbn1cclxuXHJcblxyXG4iLCJjbGFzcyBGb3JtVmFsaWRhdG9yIHtcclxuICBjb25zdHJ1Y3RvcihzZXR0aW5ncywgZm9ybUVsZW1lbnQpIHtcclxuICAgIHRoaXMuX3NldHRpbmdzID0gc2V0dGluZ3M7XHJcbiAgICB0aGlzLl9mb3JtRWxlbWVudCA9IGZvcm1FbGVtZW50O1xyXG4gICAgdGhpcy5faW5wdXRMaXN0ID0gQXJyYXkuZnJvbShcclxuICAgICAgdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCh0aGlzLl9zZXR0aW5ncy5pbnB1dFNlbGVjdG9yKVxyXG4gICAgKTtcclxuICAgIHRoaXMuX2J0bkVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICB0aGlzLl9zZXR0aW5ncy5zdWJtaXRCdXR0b25TZWxlY3RvclxyXG4gICAgKTtcclxuICB9XHJcblxyXG4gIHJlc2V0VmFsaWRhdGlvbigpIHtcclxuICAgIHRoaXMuX3RvZ2dsZUJ0blN0YXRlKCk7XHJcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGVuYWJsZVZhbGlkYXRpb24oKSB7XHJcbiAgICB0aGlzLl90b2dnbGVCdG5TdGF0ZSgpO1xyXG4gICAgdGhpcy5yZXNldFZhbGlkYXRpb24oKTtcclxuXHJcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgICAgIGlucHV0RWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKCkgPT4ge1xyXG4gICAgICAgIHRoaXMuX2hpZGVPclNob3dFcnJvcihpbnB1dEVsZW1lbnQpO1xyXG4gICAgICAgIHRoaXMuX3RvZ2dsZUJ0blN0YXRlKCk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBfaGlkZU9yU2hvd0Vycm9yID0gKGlucHV0RWxlbWVudCkgPT4ge1xyXG4gICAgaWYgKGlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZCkge1xyXG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5fc2hvd0lucHV0RXJyb3IoaW5wdXRFbGVtZW50LCBpbnB1dEVsZW1lbnQudmFsaWRhdGlvbk1lc3NhZ2UpO1xyXG4gICAgfVxyXG4gIH07XHJcblxyXG4gIF9zaG93SW5wdXRFcnJvciA9IChpbnB1dEVsZW1lbnQsIGVycm9yTXNnKSA9PiB7XHJcbiAgICBjb25zdCBlcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICBgIyR7aW5wdXRFbGVtZW50LmdldEF0dHJpYnV0ZShcIm5hbWVcIil9YFxyXG4gICAgKTtcclxuICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX3NldHRpbmdzLmlucHV0RXJyb3JDbGFzcyk7XHJcbiAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBlcnJvck1zZztcclxuICAgIGVycm9yRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX3NldHRpbmdzLmVycm9yQ2xhc3MpO1xyXG4gIH07XHJcblxyXG4gIF9oaWRlSW5wdXRFcnJvciA9IChpbnB1dEVsZW1lbnQpID0+IHtcclxuICAgIGNvbnN0IGVycm9yRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgIGAjJHtpbnB1dEVsZW1lbnQuZ2V0QXR0cmlidXRlKFwibmFtZVwiKX1gXHJcbiAgICApO1xyXG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fc2V0dGluZ3MuaW5wdXRFcnJvckNsYXNzKTtcclxuICAgIGVycm9yRWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX3NldHRpbmdzLmVycm9yQ2xhc3MpO1xyXG4gICAgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gXCJcIjtcclxuICB9O1xyXG5cclxuICBfaGFzSW52YWxpZElucHV0ID0gKGlucHV0TGlzdCkgPT4ge1xyXG4gICAgcmV0dXJuIGlucHV0TGlzdC5zb21lKChpbnB1dEVsZW1lbnQpID0+IHtcclxuICAgICAgcmV0dXJuICFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQ7XHJcbiAgICB9KTtcclxuICB9O1xyXG5cclxuICBfdG9nZ2xlQnRuU3RhdGUoKSB7XHJcbiAgICBpZiAodGhpcy5faGFzSW52YWxpZElucHV0KHRoaXMuX2lucHV0TGlzdCkpIHtcclxuICAgICAgdGhpcy5fYnRuRWxlbWVudC5zZXRBdHRyaWJ1dGUoXCJkaXNhYmxlZFwiLCB0cnVlKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuX2J0bkVsZW1lbnQucmVtb3ZlQXR0cmlidXRlKFwiZGlzYWJsZWRcIik7XHJcbiAgICB9XHJcbiAgfVxyXG59XHJcbmV4cG9ydCBkZWZhdWx0IEZvcm1WYWxpZGF0b3I7XHJcbiJdLCJuYW1lcyI6WyJQT1BVUF9BQ1RJVkVfQ0xBU1MiLCJQb3B1cCIsImNvbnN0cnVjdG9yIiwic2VsZWN0b3IiLCJ0aGlzIiwiX3NlbGVjdG9yIiwiX21vZGFsIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiX2hhbmRsZUVzY0tleSIsImJpbmQiLCJfaGFuZGxlQ2xvc2VQb3B1cCIsImV2dCIsImtleSIsImNsb3NlIiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJhZGRFdmVudExpc3RlbmVyIiwidGFyZ2V0IiwiY2xhc3NMaXN0IiwiY29udGFpbnMiLCJvcGVuIiwiYWRkIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsInJlbW92ZSIsIlBvcHVwV2l0aEZvcm0iLCJoYW5kbGVTdWJtaXQiLCJsb2FkaW5nQnRuVGV4dCIsInN1cGVyIiwiX2hhbmRsZVN1Ym1pdCIsIl9oYW5kbGVyV2l0aEZvcm0iLCJfZm9ybSIsIl9pbnB1dEZpZWxkcyIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJfc3VibWl0QnRuIiwiX2J0bkluaXRUZXh0IiwidGV4dENvbnRlbnQiLCJfbG9hZGluZ0J0blRleHQiLCJfZ2V0SW5wdXRWYWx1ZXMiLCJpbnB1dFZhbHVlcyIsImZvckVhY2giLCJmaWVsZCIsImlkIiwidmFsdWUiLCJkYXRhIiwiX3NldElucHV0VmFsdWVzIiwidmFsdWVzIiwiT2JqZWN0Iiwia2V5cyIsInByZXZlbnREZWZhdWx0Iiwic2hvd0xvYWRpbmciLCJoaWRlTG9hZGluZyIsInNldFRpbWVvdXQiLCJyZXNldCIsImJ0bkVkaXRQcm9maWxlIiwiYnRuQWRkQ2FyZCIsImJ0blByb2ZpbGVQaWN0dXJlIiwiYXBpIiwiYmFzZVVSTCIsImhlYWRlcnMiLCJyZXMiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0Iiwic3RhdHVzVGV4dCIsIl9iYXNlVVJMIiwiX2hlYWRlcnMiLCJnZXRVc2VySW5mbyIsImZldGNoIiwidGhlbiIsIl9wcm9jZXNzUmVzcG9uc2UiLCJnZXRJbml0aWFsQ2FyZHMiLCJwYXRjaFVzZXJJbmZvIiwibWV0aG9kIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJwb3N0TmV3Q2FyZCIsImRlbGV0ZUNhcmQiLCJhZGRMaWtlIiwicmVtb3ZlTGlrZSIsImNoYW5nZUF2YXRhciIsImF2YXRhciIsImdldEluaXRpYWxEYXRhIiwiYWxsIiwiYXV0aG9yaXphdGlvbiIsImdhbGxlcnlTZWN0aW9uIiwicmVuZGVyZXIiLCJfcmVuZGVyZXIiLCJfY29udGFpbmVyIiwiYWRkSXRlbSIsIml0ZW0iLCJjYXJkIiwicHJlcGVuZCIsIl9jbGVhciIsImlubmVySFRNTCIsInJlbmRlckFsbCIsIml0ZW1zIiwiY2FyZEVsZW1lbnQiLCJoYW5kbGVJbWciLCJoYW5kbGVEZWwiLCJoYW5kbGVMaWtlIiwidXNlcklkIiwiX25hbWUiLCJuYW1lIiwiX3NyYyIsImxpbmsiLCJfbGlrZXNBcnIiLCJsaWtlcyIsIl9pZCIsIm93bmVySWQiLCJvd25lciIsIl9oYW5sZGVJbWdDbGljayIsIl9oYW5kbGVEZWwiLCJfaGFuZGxlTGlrZUJ0biIsIl91c2VySWQiLCJfZ2V0VGVtcGxhdGUiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwibWFrZUNhcmQiLCJfZWxlbWVudCIsIl9pbWciLCJfY2FwdGlvbiIsIl90cmFzaCIsIl9saWtlIiwiX2xpa2VzIiwic2V0QXR0cmlidXRlIiwiX3VwZGF0ZUxpa2VzIiwiX2FkZExpc3RlbmVycyIsInNyYyIsIl9saWtlc0NvdW50IiwibGVuZ3RoIiwiX3JlbmRlckxpa2VzIiwiX2lzTGlrZWQiLCJzb21lIiwidXNlckluZm8iLCJnZXRVc2VySWQiLCJwb3B1cEltZyIsImRlbFdhcm5Qb3B1cCIsInNldEFjdGlvbiIsImNhdGNoIiwiZXJyIiwiY29uc29sZSIsImxvZyIsImZpbmFsbHkiLCJyZXNwb25zZSIsImVycm9yIiwiX2ltYWdlIiwiYWx0IiwicHJvZmlsZVBpY3R1cmVQb3B1cCIsImF2YXRhckxpbmsiLCJzZXRVc2VySW5mbyIsImVkaXRQcm9maWxlIiwiYWRkQ2FyZFBvcHVwIiwidGl0bGUiLCJpbWdMaW5rIiwiYWRkQ2FyZCIsImFjdGlvbiIsIl9uYW1lU2VsZWN0b3IiLCJuYW1lU2VsZWN0b3IiLCJfam9iU2VsZWN0b3IiLCJqb2JTZWxlY3RvciIsIl9uYW1lTm9kZSIsIl9qb2JOb2RlIiwiX3BpY3R1cmVOb2RlIiwiX2pvYiIsImFib3V0IiwibmV3RGF0YSIsInNldFVzZXJBdmF0YXIiLCJzZXRVc2VySWQiLCJmb3JtVmFsaWRhdG9ycyIsInNldHRpbmdzIiwiZm9ybVNlbGVjdG9yIiwiaW5wdXRTZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsImlucHV0RXJyb3JDbGFzcyIsImVycm9yQ2xhc3MiLCJBcnJheSIsImZyb20iLCJmb3JtRWxlbWVudCIsInZhbGlkYXRvciIsImlucHV0RWxlbWVudCIsInZhbGlkaXR5IiwidmFsaWQiLCJfaGlkZUlucHV0RXJyb3IiLCJfc2hvd0lucHV0RXJyb3IiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsImVycm9yTXNnIiwiZXJyb3JFbGVtZW50IiwiX2Zvcm1FbGVtZW50IiwiZ2V0QXR0cmlidXRlIiwiX3NldHRpbmdzIiwiaW5wdXRMaXN0IiwiX2lucHV0TGlzdCIsIl9idG5FbGVtZW50IiwicmVzZXRWYWxpZGF0aW9uIiwiX3RvZ2dsZUJ0blN0YXRlIiwiZW5hYmxlVmFsaWRhdGlvbiIsIl9oaWRlT3JTaG93RXJyb3IiLCJfaGFzSW52YWxpZElucHV0IiwicmVtb3ZlQXR0cmlidXRlIiwiZm9ybU5hbWUiLCJ1c2VyRGF0YSIsImNhcmRzQXJyYXkiXSwic291cmNlUm9vdCI6IiJ9