!function(){"use strict";var t={};function e(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}t.p="";const i="popup_active";class s{constructor(t){this._selector=t,this._modal=document.querySelector("".concat(this._selector)),this._handleEscKey=this._handleEscKey.bind(this),this._handleClosePopup=this._handleClosePopup.bind(this)}_handleEscKey(t){"Escape"===t.key&&this.close()}setEventListeners(){this._modal.addEventListener("mouseup",this._handleClosePopup)}_handleClosePopup(t){t.target.classList.contains(i)&&this.close(),t.target.classList.contains("popup__container-close")&&this.close()}open(){document.addEventListener("keyup",this._handleEscKey),this._modal.classList.add(i)}close(){document.removeEventListener("keyup",this._handleEscKey),this._modal.classList.remove(i)}}class n extends s{constructor(t){let{selector:e,handleSubmit:i}=t;super(e),this._handleSubmit=i,this._handleSubmit=this._handleSubmit.bind(this),this._handlerWithForm=this._handlerWithForm.bind(this),this._form=this._modal.querySelector(".popup-edit"),this._inputFields=[...this._form.querySelectorAll(".popup-edit__field")]}getInputValues(){const t={};return this._inputFields.forEach((e=>{t[e.name]=e.value})),t}open(t){t&&this._setInputValues(t),super.open()}_setInputValues(t){this._inputFields.forEach((e=>{Object.keys(t).forEach((i=>{e.name===i&&(e.value=t[i])}))}))}_handlerWithForm(t){t.preventDefault(),this._handleSubmit(this.getInputValues()),this.close()}setEventListeners(){this._form.addEventListener("submit",this._handlerWithForm),super.setEventListeners()}close(){this._form.removeEventListener("submit",this._handlerWithForm),super.close(),this._form.reset()}}var r=t.p+"70b05f1de5958b9cceb8.png",o=t.p+"ca15aa5935d8be081eaa.png",a=t.p+"b9b331806393d4bf6e61.png",l=t.p+"5a4294ef9ff4b49491bd.jpg",c=t.p+"7dfd6e25a55c92a9bdd3.jpg",h=t.p+"db1c91c5d15366a0295b.jpg";const d=document.querySelector(".profile__edit-button"),_=document.querySelector(".profile__add-btn"),u=[{imgTitle:"Yosemite Valley",imgLink:r,alt:"Yosemite el capitan"},{imgTitle:"Lake Louise",imgLink:o,alt:"Lake Louise"},{imgTitle:"Bald Mountains",imgLink:a,alt:"Bald Mountains"},{imgTitle:"Latemar",imgLink:l,alt:"Latemar"},{imgTitle:"Vanoise National Park",imgLink:c,alt:"Vanoise National Park"},{imgTitle:"Lago di Braies",imgLink:h,alt:"Lago di Braies"}],m=new class{constructor(t,e){let{items:i,renderer:s}=t;this._renderItems=i,this._renderer=s,this._container=document.querySelector(e)}addItem(t){const e=this._renderer(t);this._container.prepend(e)}_clear(){this._container.innerHTML=""}renderAll(){this._clear(),this._renderItems.forEach((t=>{this.addItem(t)}))}}({items:u,renderer:t=>function(t){const e=new class{constructor(t,e,i){let{imgTitle:s,imgLink:n}=t;this._name=s,this._src=n,this._selector=e,this._hanldeImgClick=i}_getTemplate(){const t=document.querySelector("".concat(this._selector)).content.cloneNode(!0);return this._img=t.querySelector(".card__img"),this._caption=t.querySelector(".card__caption"),this._trash=t.querySelector(".card__trash"),this._like=t.querySelector(".card__like-btn"),t}makeCard(){return this._element=this._getTemplate(),this._img.setAttribute("src",this._src),this._img.setAttribute("alt",this._name),this._caption.textContent=this._name,this._addListeners(),this._element}_addListeners(){this._like.addEventListener("click",(()=>this._handleLikeBtn())),this._img.addEventListener("click",(()=>this._hanldeImgClick({name:this._name,src:this._src}))),this._trash.addEventListener("click",(t=>t.target.closest(".card").remove()))}_handleLikeBtn(){this._like.classList.toggle("card__like-btn_active")}}({imgTitle:t.imgTitle,imgLink:t.imgLink},"#card",(t=>{p.open(t)}));return e.makeCard()}(t)},".gallery");m.renderAll();const p=new class extends s{constructor(t){super(t),this._image=this._modal.querySelector(".img-popout__img"),this._caption=this._modal.querySelector(".img-popout__caption")}open(t){this._image.src=t.src,this._image.alt=t.name,this._caption.textContent=t.name,super.open()}}("#imgPopup");p.setEventListeners();const g=new n({selector:"#profilePopup",handleSubmit:()=>{L.setUserInfo(g.getInputValues()),g.close()}});g.setEventListeners();const b=new n({selector:"#addCardPopup",handleSubmit:t=>{m.addItem(t)}});b.setEventListeners();const L=new class{constructor(t){this._nameSelector=t.nameSelector,this._jobSelector=t.jobSelector,this._nameNode=document.querySelector("".concat(this._nameSelector)),this._jobNode=document.querySelector("".concat(this._jobSelector))}getUserInfo(){return this._name=this._nameNode.textContent,this._job=this._jobNode.textContent,{name:this._name,about:this._job}}setUserInfo(t){this._nameNode.textContent=t.name,this._jobNode.textContent=t.about}}({nameSelector:".profile__user-name",jobSelector:".profile__user-about"}),f={};var E;E={formSelector:".popup-edit",inputSelector:".popup-edit__field",submitButtonSelector:".popup-edit__submit",inactiveButtonClass:"",inputErrorClass:"popup-edit__field_error",errorClass:"popup-edit__error-msg_inactive"},Array.from(document.querySelectorAll(E.formSelector)).forEach((t=>{const i=new class{constructor(t,i){e(this,"_hideOrShowError",(t=>{t.validity.valid?this._hideInputError(t):this._showInputError(t,t.validationMessage)})),e(this,"_showInputError",((t,e)=>{const i=this._formElement.querySelector("#".concat(t.getAttribute("name")));t.classList.add(this._settings.inputErrorClass),i.textContent=e,i.classList.remove(this._settings.errorClass)})),e(this,"_hideInputError",(t=>{const e=this._formElement.querySelector("#".concat(t.getAttribute("name")));t.classList.remove(this._settings.inputErrorClass),e.classList.add(this._settings.errorClass),e.textContent=""})),e(this,"_hasInvalidInput",(t=>t.some((t=>!t.validity.valid)))),this._settings=t,this._formElement=i,this._inputList=Array.from(this._formElement.querySelectorAll(this._settings.inputSelector)),this._btnElement=this._formElement.querySelector(this._settings.submitButtonSelector)}resetValidation(){this._toggleBtnState(),this._inputList.forEach((t=>{this._hideInputError(t)}))}enableValidation(){this._toggleBtnState(),this.resetValidation(),this._inputList.forEach((t=>{t.addEventListener("input",(()=>{this._hideOrShowError(t),this._toggleBtnState()}))}))}_toggleBtnState(){this._hasInvalidInput(this._inputList)?this._btnElement.setAttribute("disabled",""):this._btnElement.removeAttribute("disabled","")}}(E,t),s=t.getAttribute("name");f[s]=i,i.enableValidation()})),d.addEventListener("click",(function(){const t=L.getUserInfo();g.open(t),f.editProfileForm.resetValidation()})),_.addEventListener("click",(function(){f.addCardForm.resetValidation(),b.open()}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC93ZWJwYWNrL3J1bnRpbWUvcHVibGljUGF0aCIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL3NjcmlwdHMvY29tcG9uZW50cy9Qb3B1cC5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL3NjcmlwdHMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3Jtcy5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL3NjcmlwdHMvdXRpbHMvY29uc3RhbnRzLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvcGFnZS9pbmRleC5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL3NjcmlwdHMvY29tcG9uZW50cy9TZWN0aW9uLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvc2NyaXB0cy9jb21wb25lbnRzL0NhcmQuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9zY3JpcHRzL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2VzLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvc2NyaXB0cy9jb21wb25lbnRzL1VzZXJJbmZvLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvc2NyaXB0cy9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gVGhlIHJlcXVpcmUgc2NvcGVcbnZhciBfX3dlYnBhY2tfcmVxdWlyZV9fID0ge307XG5cbiIsIl9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7IiwiY29uc3QgUE9QVVBfQUNUSVZFX0NMQVNTID0gXCJwb3B1cF9hY3RpdmVcIjtcclxuY29uc3QgUE9QVVBfQ0xPU0VfQlROX1NFTEVDVE9SID0gXCJwb3B1cF9fY29udGFpbmVyLWNsb3NlXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3Ioc2VsZWN0b3IpIHtcclxuICAgIHRoaXMuX3NlbGVjdG9yID0gc2VsZWN0b3I7XHJcbiAgICB0aGlzLl9tb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYCR7dGhpcy5fc2VsZWN0b3J9YCk7XHJcbiAgICB0aGlzLl9oYW5kbGVFc2NLZXkgPSB0aGlzLl9oYW5kbGVFc2NLZXkuYmluZCh0aGlzKTtcclxuICAgIHRoaXMuX2hhbmRsZUNsb3NlUG9wdXAgPSB0aGlzLl9oYW5kbGVDbG9zZVBvcHVwLmJpbmQodGhpcyk7XHJcbiAgfVxyXG5cclxuICBfaGFuZGxlRXNjS2V5KGV2dCkge1xyXG4gICAgaWYgKGV2dC5rZXkgPT09IFwiRXNjYXBlXCIpIHtcclxuICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICB0aGlzLl9tb2RhbC5hZGRFdmVudExpc3RlbmVyKFwibW91c2V1cFwiLCB0aGlzLl9oYW5kbGVDbG9zZVBvcHVwKTtcclxuICB9XHJcblxyXG4gIF9oYW5kbGVDbG9zZVBvcHVwKGV2dCkge1xyXG4gICAgaWYgKGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFBPUFVQX0FDVElWRV9DTEFTUykpIHtcclxuICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgfVxyXG4gICAgaWYgKGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFBPUFVQX0NMT1NFX0JUTl9TRUxFQ1RPUikpIHtcclxuICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgb3BlbigpIHtcclxuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXl1cFwiLCB0aGlzLl9oYW5kbGVFc2NLZXkpO1xyXG4gICAgdGhpcy5fbW9kYWwuY2xhc3NMaXN0LmFkZChQT1BVUF9BQ1RJVkVfQ0xBU1MpO1xyXG4gIH1cclxuXHJcbiAgY2xvc2UoKSB7XHJcbiAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5dXBcIiwgdGhpcy5faGFuZGxlRXNjS2V5KTtcclxuICAgIHRoaXMuX21vZGFsLmNsYXNzTGlzdC5yZW1vdmUoUE9QVVBfQUNUSVZFX0NMQVNTKTtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XHJcblxyXG5jb25zdCBGT1JNX1NFTEVDVE9SID0gXCIucG9wdXAtZWRpdFwiO1xyXG5jb25zdCBGT1JNX0lOUFVUX0ZJRUxEX1NFTEVDVE9SID0gXCIucG9wdXAtZWRpdF9fZmllbGRcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEZvcm1zIGV4dGVuZHMgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHsgc2VsZWN0b3IsIGhhbmRsZVN1Ym1pdCB9KSB7XHJcbiAgICBzdXBlcihzZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9oYW5kbGVTdWJtaXQgPSBoYW5kbGVTdWJtaXQ7XHJcbiAgICB0aGlzLl9oYW5kbGVTdWJtaXQgPSB0aGlzLl9oYW5kbGVTdWJtaXQuYmluZCh0aGlzKTtcclxuICAgIHRoaXMuX2hhbmRsZXJXaXRoRm9ybSA9IHRoaXMuX2hhbmRsZXJXaXRoRm9ybS5iaW5kKHRoaXMpO1xyXG4gICAgdGhpcy5fZm9ybSA9IHRoaXMuX21vZGFsLnF1ZXJ5U2VsZWN0b3IoRk9STV9TRUxFQ1RPUik7XHJcbiAgICB0aGlzLl9pbnB1dEZpZWxkcyA9IFtcclxuICAgICAgLi4udGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yQWxsKEZPUk1fSU5QVVRfRklFTERfU0VMRUNUT1IpLFxyXG4gICAgXTtcclxuICB9XHJcblxyXG4gIGdldElucHV0VmFsdWVzKCkge1xyXG4gICAgY29uc3QgaW5wdXRWYWx1ZXMgPSB7fTtcclxuICAgIHRoaXMuX2lucHV0RmllbGRzLmZvckVhY2goKGZpZWxkKSA9PiB7XHJcbiAgICAgIGlucHV0VmFsdWVzW2ZpZWxkLm5hbWVdID0gZmllbGQudmFsdWU7XHJcbiAgICB9KTtcclxuICAgIHJldHVybiBpbnB1dFZhbHVlcztcclxuICB9XHJcblxyXG4gIG9wZW4oZGF0YSkge1xyXG4gICAgaWYgKGRhdGEpIHRoaXMuX3NldElucHV0VmFsdWVzKGRhdGEpO1xyXG4gICAgc3VwZXIub3BlbigpO1xyXG4gIH1cclxuXHJcbiAgX3NldElucHV0VmFsdWVzKHZhbHVlcykge1xyXG4gICAgdGhpcy5faW5wdXRGaWVsZHMuZm9yRWFjaCgoZmllbGQpID0+IHtcclxuICAgICAgT2JqZWN0LmtleXModmFsdWVzKS5mb3JFYWNoKChrZXkpID0+IHtcclxuICAgICAgICBpZiAoZmllbGQubmFtZSA9PT0ga2V5KSB7XHJcbiAgICAgICAgICBmaWVsZC52YWx1ZSA9IHZhbHVlc1trZXldO1xyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIF9oYW5kbGVyV2l0aEZvcm0oZXZ0KSB7XHJcbiAgICB7XHJcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICB0aGlzLl9oYW5kbGVTdWJtaXQodGhpcy5nZXRJbnB1dFZhbHVlcygpKTtcclxuICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgfVxyXG4gIH1cclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHRoaXMuX2Zvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCB0aGlzLl9oYW5kbGVyV2l0aEZvcm0pO1xyXG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICB9XHJcblxyXG4gIGNsb3NlKCkge1xyXG4gICAgdGhpcy5fZm9ybS5yZW1vdmVFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIHRoaXMuX2hhbmRsZXJXaXRoRm9ybSk7XHJcbiAgICBzdXBlci5jbG9zZSgpO1xyXG4gICAgdGhpcy5fZm9ybS5yZXNldCgpO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgeW9zZW1pdGUgZnJvbSBcIi4uLy4uL2ltYWdlcy9raXJpbGwtcGVyc2hpbi0xMDg4NDA0LXVuc3BsYXNoLnBuZ1wiO1xyXG5pbXBvcnQgbExvdWlzZSBmcm9tIFwiLi4vLi4vaW1hZ2VzL2tpcmlsbC1wZXJzaGluLTE0MDQ2ODEtdW5zcGxhc2gucG5nXCI7XHJcbmltcG9ydCBiTW91bnRhaW5zIGZyb20gXCIuLi8uLi9pbWFnZXMva2lyaWxsLXBlcnNoaW4tMTU1NjM1NS11bnNwbGFzaC5wbmdcIjtcclxuaW1wb3J0IGxhdGVtYXIgZnJvbSBcIi4uLy4uL2ltYWdlcy9wZXRlci1zdGVpbmVyLUZycWlYRHh4T0dzLXVuc3BsYXNoLmpwZ1wiO1xyXG5pbXBvcnQgdmFub2lzZSBmcm9tIFwiLi4vLi4vaW1hZ2VzL2ZyZXlzdGVpbm4tZy1qb25zc29uLUViazFNQmVycHdvLXVuc3BsYXNoLmpwZ1wiO1xyXG5pbXBvcnQgY2FjdHVzIGZyb20gXCIuLi8uLi9pbWFnZXMvamVyZW15LWFsZm9yZC1XaGJMbWhhaXVfdy11bnNwbGFzaC5qcGdcIjtcclxuXHJcbmNvbnN0IGJ0bkVkaXRQcm9maWxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19lZGl0LWJ1dHRvblwiKTtcclxuY29uc3QgYnRuQWRkQ2FyZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYWRkLWJ0blwiKTtcclxuXHJcbmNvbnN0IGluaXRpYWxDYXJkcyA9IFtcclxuICB7XHJcbiAgICBpbWdUaXRsZTogXCJZb3NlbWl0ZSBWYWxsZXlcIixcclxuICAgIGltZ0xpbms6IHlvc2VtaXRlLFxyXG4gICAgYWx0OiBcIllvc2VtaXRlIGVsIGNhcGl0YW5cIixcclxuICB9LFxyXG4gIHtcclxuICAgIGltZ1RpdGxlOiBcIkxha2UgTG91aXNlXCIsXHJcbiAgICBpbWdMaW5rOiBsTG91aXNlLFxyXG4gICAgYWx0OiBcIkxha2UgTG91aXNlXCIsXHJcbiAgfSxcclxuICB7XHJcbiAgICBpbWdUaXRsZTogXCJCYWxkIE1vdW50YWluc1wiLFxyXG4gICAgaW1nTGluazogYk1vdW50YWlucyxcclxuICAgIGFsdDogXCJCYWxkIE1vdW50YWluc1wiLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgaW1nVGl0bGU6IFwiTGF0ZW1hclwiLFxyXG4gICAgaW1nTGluazogbGF0ZW1hcixcclxuICAgIGFsdDogXCJMYXRlbWFyXCIsXHJcbiAgfSxcclxuICB7XHJcbiAgICBpbWdUaXRsZTogXCJWYW5vaXNlIE5hdGlvbmFsIFBhcmtcIixcclxuICAgIGltZ0xpbms6IHZhbm9pc2UsXHJcbiAgICBhbHQ6IFwiVmFub2lzZSBOYXRpb25hbCBQYXJrXCIsXHJcbiAgfSxcclxuICB7XHJcbiAgICBpbWdUaXRsZTogXCJMYWdvIGRpIEJyYWllc1wiLFxyXG4gICAgaW1nTGluazogY2FjdHVzLFxyXG4gICAgYWx0OiBcIkxhZ28gZGkgQnJhaWVzXCIsXHJcbiAgfSxcclxuXTtcclxuXHJcbmNvbnN0IHNldHRpbmdzID0ge1xyXG4gIGZvcm1TZWxlY3RvcjogXCIucG9wdXAtZWRpdFwiLFxyXG4gIGlucHV0U2VsZWN0b3I6IFwiLnBvcHVwLWVkaXRfX2ZpZWxkXCIsXHJcbiAgc3VibWl0QnV0dG9uU2VsZWN0b3I6IFwiLnBvcHVwLWVkaXRfX3N1Ym1pdFwiLFxyXG4gIGluYWN0aXZlQnV0dG9uQ2xhc3M6IFwiXCIsXHJcbiAgaW5wdXRFcnJvckNsYXNzOiBcInBvcHVwLWVkaXRfX2ZpZWxkX2Vycm9yXCIsXHJcbiAgZXJyb3JDbGFzczogXCJwb3B1cC1lZGl0X19lcnJvci1tc2dfaW5hY3RpdmVcIixcclxufTtcclxuXHJcbmV4cG9ydCB7IGJ0bkVkaXRQcm9maWxlLCBidG5BZGRDYXJkLCBpbml0aWFsQ2FyZHMsIHNldHRpbmdzIH07XHJcbiIsImltcG9ydCBcIi4vaW5kZXguY3NzXCI7XHJcbmltcG9ydCBGb3JtVmFsaWRhdG9yIGZyb20gXCIuLi9zY3JpcHRzL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qc1wiO1xyXG5pbXBvcnQgQ2FyZCBmcm9tIFwiLi4vc2NyaXB0cy9jb21wb25lbnRzL0NhcmQuanNcIjtcclxuaW1wb3J0IFNlY3Rpb24gZnJvbSBcIi4uL3NjcmlwdHMvY29tcG9uZW50cy9TZWN0aW9uLmpzXCI7XHJcbmltcG9ydCBQb3B1cFdpdGhJbWFnZXMgZnJvbSBcIi4uL3NjcmlwdHMvY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZXMuanNcIjtcclxuaW1wb3J0IFVzZXJJbmZvIGZyb20gXCIuLi9zY3JpcHRzL2NvbXBvbmVudHMvVXNlckluZm8uanNcIjtcclxuaW1wb3J0IFBvcHVwV2l0aEZvcm1zIGZyb20gXCIuLi9zY3JpcHRzL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybXMuanNcIjtcclxuaW1wb3J0IHtcclxuICBidG5FZGl0UHJvZmlsZSxcclxuICBidG5BZGRDYXJkLFxyXG4gIGluaXRpYWxDYXJkcyxcclxuICBzZXR0aW5ncyxcclxufSBmcm9tIFwiLi4vc2NyaXB0cy91dGlscy9jb25zdGFudHMuanNcIjtcclxuXHJcbmZ1bmN0aW9uIGNyZWF0ZUNhcmQoaXRlbSkge1xyXG4gIGNvbnN0IGNhcmRFbGVtZW50ID0gbmV3IENhcmQoXHJcbiAgICB7IGltZ1RpdGxlOiBpdGVtLmltZ1RpdGxlLCBpbWdMaW5rOiBpdGVtLmltZ0xpbmsgfSxcclxuICAgIFwiI2NhcmRcIixcclxuICAgIChpdGVtKSA9PiB7XHJcbiAgICAgIHBvcHVwSW1nLm9wZW4oaXRlbSk7XHJcbiAgICB9XHJcbiAgKTtcclxuICByZXR1cm4gY2FyZEVsZW1lbnQubWFrZUNhcmQoKTtcclxufVxyXG5cclxuY29uc3QgZ2FsbGVyeVNlY3Rpb24gPSBuZXcgU2VjdGlvbihcclxuICB7XHJcbiAgICBpdGVtczogaW5pdGlhbENhcmRzLFxyXG4gICAgcmVuZGVyZXI6IChpdGVtKSA9PiB7XHJcbiAgICAgIHJldHVybiBjcmVhdGVDYXJkKGl0ZW0pO1xyXG4gICAgfSxcclxuICB9LFxyXG4gIFwiLmdhbGxlcnlcIlxyXG4pO1xyXG5nYWxsZXJ5U2VjdGlvbi5yZW5kZXJBbGwoKTtcclxuXHJcbmNvbnN0IHBvcHVwSW1nID0gbmV3IFBvcHVwV2l0aEltYWdlcyhcIiNpbWdQb3B1cFwiKTtcclxucG9wdXBJbWcuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbmV4cG9ydCBjb25zdCBlZGl0UHJvZmlsZSA9IG5ldyBQb3B1cFdpdGhGb3Jtcyh7XHJcbiAgc2VsZWN0b3I6IFwiI3Byb2ZpbGVQb3B1cFwiLFxyXG4gIGhhbmRsZVN1Ym1pdDogKCkgPT4ge1xyXG4gICAgdXNlckluZm8uc2V0VXNlckluZm8oZWRpdFByb2ZpbGUuZ2V0SW5wdXRWYWx1ZXMoKSk7XHJcbiAgICBlZGl0UHJvZmlsZS5jbG9zZSgpO1xyXG4gIH0sXHJcbn0pO1xyXG5lZGl0UHJvZmlsZS5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuZXhwb3J0IGNvbnN0IGFkZENhcmQgPSBuZXcgUG9wdXBXaXRoRm9ybXMoe1xyXG4gIHNlbGVjdG9yOiBcIiNhZGRDYXJkUG9wdXBcIixcclxuICBoYW5kbGVTdWJtaXQ6IChkYXRhKSA9PiB7XHJcbiAgICBnYWxsZXJ5U2VjdGlvbi5hZGRJdGVtKGRhdGEpO1xyXG4gIH0sXHJcbn0pO1xyXG5hZGRDYXJkLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG5jb25zdCB1c2VySW5mbyA9IG5ldyBVc2VySW5mbyh7XHJcbiAgbmFtZVNlbGVjdG9yOiBcIi5wcm9maWxlX191c2VyLW5hbWVcIixcclxuICBqb2JTZWxlY3RvcjogXCIucHJvZmlsZV9fdXNlci1hYm91dFwiLFxyXG59KTtcclxuXHJcbmNvbnN0IGZvcm1WYWxpZGF0b3JzID0ge307XHJcbmNvbnN0IGVuYWJsZVZhbGlkYXRpb24gPSAoc2V0dGluZ3MpID0+IHtcclxuICBjb25zdCBmb3JtTGlzdCA9IEFycmF5LmZyb20oZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChzZXR0aW5ncy5mb3JtU2VsZWN0b3IpKTtcclxuICBmb3JtTGlzdC5mb3JFYWNoKChmb3JtRWxlbWVudCkgPT4ge1xyXG4gICAgY29uc3QgdmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3Ioc2V0dGluZ3MsIGZvcm1FbGVtZW50KTtcclxuXHJcbiAgICBjb25zdCBmb3JtTmFtZSA9IGZvcm1FbGVtZW50LmdldEF0dHJpYnV0ZShcIm5hbWVcIik7XHJcblxyXG4gICAgZm9ybVZhbGlkYXRvcnNbZm9ybU5hbWVdID0gdmFsaWRhdG9yO1xyXG4gICAgdmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcclxuICB9KTtcclxufTtcclxuXHJcbmVuYWJsZVZhbGlkYXRpb24oc2V0dGluZ3MpO1xyXG5cclxuYnRuRWRpdFByb2ZpbGUuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGhhbmRsZUVkaXRQcm9maWxlQnRuKTtcclxuXHJcbmJ0bkFkZENhcmQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGhhbmRsZUFkZENhcmQpO1xyXG5cclxuZnVuY3Rpb24gaGFuZGxlRWRpdFByb2ZpbGVCdG4oKSB7XHJcbiAgY29uc3QgZGF0YSA9IHVzZXJJbmZvLmdldFVzZXJJbmZvKCk7XHJcbiAgZWRpdFByb2ZpbGUub3BlbihkYXRhKTtcclxuICBmb3JtVmFsaWRhdG9yc1tcImVkaXRQcm9maWxlRm9ybVwiXS5yZXNldFZhbGlkYXRpb24oKTtcclxufVxyXG5cclxuZnVuY3Rpb24gaGFuZGxlQWRkQ2FyZCgpIHtcclxuICBmb3JtVmFsaWRhdG9yc1tcImFkZENhcmRGb3JtXCJdLnJlc2V0VmFsaWRhdGlvbigpO1xyXG4gIGFkZENhcmQub3BlbigpO1xyXG59XHJcblxyXG5leHBvcnQgeyB1c2VySW5mbywgZm9ybVZhbGlkYXRvcnMgfTtcclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgU2VjdGlvbiB7XHJcbiAgY29uc3RydWN0b3IoeyBpdGVtcywgcmVuZGVyZXIgfSwgc2VsZWN0b3IpIHtcclxuICAgIHRoaXMuX3JlbmRlckl0ZW1zID0gaXRlbXM7XHJcbiAgICB0aGlzLl9yZW5kZXJlciA9IHJlbmRlcmVyO1xyXG4gICAgdGhpcy5fY29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihzZWxlY3Rvcik7XHJcbiAgfVxyXG5cclxuICBhZGRJdGVtKGl0ZW0pIHtcclxuICAgIGNvbnN0IGNhcmQgPSB0aGlzLl9yZW5kZXJlcihpdGVtKTtcclxuICAgIHRoaXMuX2NvbnRhaW5lci5wcmVwZW5kKGNhcmQpO1xyXG4gIH1cclxuXHJcbiAgX2NsZWFyKCkge1xyXG4gICAgdGhpcy5fY29udGFpbmVyLmlubmVySFRNTCA9IFwiXCI7XHJcbiAgfVxyXG5cclxuICByZW5kZXJBbGwoKSB7XHJcbiAgICB0aGlzLl9jbGVhcigpO1xyXG5cclxuICAgIHRoaXMuX3JlbmRlckl0ZW1zLmZvckVhY2goKGl0ZW0pID0+IHtcclxuICAgICAgdGhpcy5hZGRJdGVtKGl0ZW0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG59XHJcbiIsImNsYXNzIENhcmQge1xyXG4gIGNvbnN0cnVjdG9yKHsgaW1nVGl0bGUsIGltZ0xpbmsgfSwgc2VsZWN0b3IsIGhhbmRsZXIpIHtcclxuICAgIHRoaXMuX25hbWUgPSBpbWdUaXRsZTtcclxuICAgIHRoaXMuX3NyYyA9IGltZ0xpbms7XHJcbiAgICB0aGlzLl9zZWxlY3RvciA9IHNlbGVjdG9yO1xyXG4gICAgdGhpcy5faGFubGRlSW1nQ2xpY2sgPSBoYW5kbGVyO1xyXG4gIH1cclxuXHJcbiAgX2dldFRlbXBsYXRlKCkge1xyXG4gICAgY29uc3QgY2FyZEVsZW1lbnQgPSBkb2N1bWVudFxyXG4gICAgICAucXVlcnlTZWxlY3RvcihgJHt0aGlzLl9zZWxlY3Rvcn1gKVxyXG4gICAgICAuY29udGVudC5jbG9uZU5vZGUodHJ1ZSk7XHJcbiAgICB0aGlzLl9pbWcgPSBjYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2ltZ1wiKTtcclxuICAgIHRoaXMuX2NhcHRpb24gPSBjYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2NhcHRpb25cIik7XHJcbiAgICB0aGlzLl90cmFzaCA9IGNhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fdHJhc2hcIik7XHJcbiAgICB0aGlzLl9saWtlID0gY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19saWtlLWJ0blwiKTtcclxuXHJcbiAgICByZXR1cm4gY2FyZEVsZW1lbnQ7XHJcbiAgfVxyXG5cclxuICBtYWtlQ2FyZCgpIHtcclxuICAgIHRoaXMuX2VsZW1lbnQgPSB0aGlzLl9nZXRUZW1wbGF0ZSgpO1xyXG4gICAgdGhpcy5faW1nLnNldEF0dHJpYnV0ZShcInNyY1wiLCB0aGlzLl9zcmMpO1xyXG4gICAgdGhpcy5faW1nLnNldEF0dHJpYnV0ZShcImFsdFwiLCB0aGlzLl9uYW1lKTtcclxuICAgIHRoaXMuX2NhcHRpb24udGV4dENvbnRlbnQgPSB0aGlzLl9uYW1lO1xyXG4gICAgdGhpcy5fYWRkTGlzdGVuZXJzKCk7XHJcbiAgICByZXR1cm4gdGhpcy5fZWxlbWVudDtcclxuICB9XHJcblxyXG4gIF9hZGRMaXN0ZW5lcnMoKSB7XHJcbiAgICB0aGlzLl9saWtlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB0aGlzLl9oYW5kbGVMaWtlQnRuKCkpO1xyXG4gICAgdGhpcy5faW1nLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PlxyXG4gICAgICB0aGlzLl9oYW5sZGVJbWdDbGljayh7IG5hbWU6IHRoaXMuX25hbWUsIHNyYzogdGhpcy5fc3JjIH0pXHJcbiAgICApO1xyXG4gICAgdGhpcy5fdHJhc2guYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChldnQpID0+XHJcbiAgICAgIGV2dC50YXJnZXQuY2xvc2VzdChcIi5jYXJkXCIpLnJlbW92ZSgpXHJcbiAgICApO1xyXG4gIH1cclxuXHJcbiAgX2hhbmRsZUxpa2VCdG4oKSB7XHJcbiAgICB0aGlzLl9saWtlLmNsYXNzTGlzdC50b2dnbGUoXCJjYXJkX19saWtlLWJ0bl9hY3RpdmVcIik7XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBDYXJkO1xyXG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEltYWdlcyBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3RvcihzZWxlY3Rvcikge1xyXG4gICAgc3VwZXIoc2VsZWN0b3IpO1xyXG4gICAgdGhpcy5faW1hZ2UgPSB0aGlzLl9tb2RhbC5xdWVyeVNlbGVjdG9yKFwiLmltZy1wb3BvdXRfX2ltZ1wiKTtcclxuICAgIHRoaXMuX2NhcHRpb24gPSB0aGlzLl9tb2RhbC5xdWVyeVNlbGVjdG9yKFwiLmltZy1wb3BvdXRfX2NhcHRpb25cIik7XHJcbiAgfVxyXG5cclxuICBvcGVuKGRhdGEpIHtcclxuICAgIHRoaXMuX2ltYWdlLnNyYyA9IGRhdGEuc3JjO1xyXG4gICAgdGhpcy5faW1hZ2UuYWx0ID0gZGF0YS5uYW1lO1xyXG4gICAgdGhpcy5fY2FwdGlvbi50ZXh0Q29udGVudCA9IGRhdGEubmFtZTtcclxuICAgIHN1cGVyLm9wZW4oKTtcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgVXNlckluZm8ge1xyXG4gIGNvbnN0cnVjdG9yKGRhdGEpIHtcclxuICAgIHRoaXMuX25hbWVTZWxlY3RvciA9IGRhdGEubmFtZVNlbGVjdG9yO1xyXG4gICAgdGhpcy5fam9iU2VsZWN0b3IgPSBkYXRhLmpvYlNlbGVjdG9yO1xyXG4gICAgdGhpcy5fbmFtZU5vZGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAke3RoaXMuX25hbWVTZWxlY3Rvcn1gKTtcclxuICAgIHRoaXMuX2pvYk5vZGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAke3RoaXMuX2pvYlNlbGVjdG9yfWApO1xyXG4gIH1cclxuXHJcbiAgZ2V0VXNlckluZm8oKSB7XHJcbiAgICB0aGlzLl9uYW1lID0gdGhpcy5fbmFtZU5vZGUudGV4dENvbnRlbnQ7XHJcbiAgICB0aGlzLl9qb2IgPSB0aGlzLl9qb2JOb2RlLnRleHRDb250ZW50O1xyXG5cclxuICAgIHJldHVybiB7IG5hbWU6IHRoaXMuX25hbWUsIGFib3V0OiB0aGlzLl9qb2IgfTtcclxuICB9XHJcblxyXG4gIHNldFVzZXJJbmZvKG5ld0RhdGEpIHtcclxuICAgIHRoaXMuX25hbWVOb2RlLnRleHRDb250ZW50ID0gbmV3RGF0YS5uYW1lO1xyXG4gICAgdGhpcy5fam9iTm9kZS50ZXh0Q29udGVudCA9IG5ld0RhdGEuYWJvdXQ7XHJcbiAgfVxyXG59XHJcbiIsImNsYXNzIEZvcm1WYWxpZGF0b3Ige1xyXG4gIGNvbnN0cnVjdG9yKHNldHRpbmdzLCBmb3JtRWxlbWVudCkge1xyXG4gICAgdGhpcy5fc2V0dGluZ3MgPSBzZXR0aW5ncztcclxuICAgIHRoaXMuX2Zvcm1FbGVtZW50ID0gZm9ybUVsZW1lbnQ7XHJcbiAgICB0aGlzLl9pbnB1dExpc3QgPSBBcnJheS5mcm9tKFxyXG4gICAgICB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKHRoaXMuX3NldHRpbmdzLmlucHV0U2VsZWN0b3IpXHJcbiAgICApO1xyXG4gICAgdGhpcy5fYnRuRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgIHRoaXMuX3NldHRpbmdzLnN1Ym1pdEJ1dHRvblNlbGVjdG9yXHJcbiAgICApO1xyXG4gIH1cclxuXHJcbiAgcmVzZXRWYWxpZGF0aW9uKCkge1xyXG4gICAgdGhpcy5fdG9nZ2xlQnRuU3RhdGUoKTtcclxuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcclxuICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZW5hYmxlVmFsaWRhdGlvbigpIHtcclxuICAgIHRoaXMuX3RvZ2dsZUJ0blN0YXRlKCk7XHJcbiAgICB0aGlzLnJlc2V0VmFsaWRhdGlvbigpO1xyXG5cclxuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcclxuICAgICAgaW5wdXRFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCAoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5faGlkZU9yU2hvd0Vycm9yKGlucHV0RWxlbWVudCk7XHJcbiAgICAgICAgdGhpcy5fdG9nZ2xlQnRuU3RhdGUoKTtcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIF9oaWRlT3JTaG93RXJyb3IgPSAoaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgICBpZiAoaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkKSB7XHJcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9zaG93SW5wdXRFcnJvcihpbnB1dEVsZW1lbnQsIGlucHV0RWxlbWVudC52YWxpZGF0aW9uTWVzc2FnZSk7XHJcbiAgICB9XHJcbiAgfTtcclxuXHJcbiAgX3Nob3dJbnB1dEVycm9yID0gKGlucHV0RWxlbWVudCwgZXJyb3JNc2cpID0+IHtcclxuICAgIGNvbnN0IGVycm9yRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgIGAjJHtpbnB1dEVsZW1lbnQuZ2V0QXR0cmlidXRlKFwibmFtZVwiKX1gXHJcbiAgICApO1xyXG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5fc2V0dGluZ3MuaW5wdXRFcnJvckNsYXNzKTtcclxuICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IGVycm9yTXNnO1xyXG4gICAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fc2V0dGluZ3MuZXJyb3JDbGFzcyk7XHJcbiAgfTtcclxuXHJcbiAgX2hpZGVJbnB1dEVycm9yID0gKGlucHV0RWxlbWVudCkgPT4ge1xyXG4gICAgY29uc3QgZXJyb3JFbGVtZW50ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgICAgYCMke2lucHV0RWxlbWVudC5nZXRBdHRyaWJ1dGUoXCJuYW1lXCIpfWBcclxuICAgICk7XHJcbiAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9zZXR0aW5ncy5pbnB1dEVycm9yQ2xhc3MpO1xyXG4gICAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5fc2V0dGluZ3MuZXJyb3JDbGFzcyk7XHJcbiAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBcIlwiO1xyXG4gIH07XHJcblxyXG4gIF9oYXNJbnZhbGlkSW5wdXQgPSAoaW5wdXRMaXN0KSA9PiB7XHJcbiAgICByZXR1cm4gaW5wdXRMaXN0LnNvbWUoKGlucHV0RWxlbWVudCkgPT4ge1xyXG4gICAgICByZXR1cm4gIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZDtcclxuICAgIH0pO1xyXG4gIH07XHJcblxyXG4gIF90b2dnbGVCdG5TdGF0ZSgpIHtcclxuICAgIGlmICh0aGlzLl9oYXNJbnZhbGlkSW5wdXQodGhpcy5faW5wdXRMaXN0KSkge1xyXG4gICAgICB0aGlzLl9idG5FbGVtZW50LnNldEF0dHJpYnV0ZShcImRpc2FibGVkXCIsIFwiXCIpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5fYnRuRWxlbWVudC5yZW1vdmVBdHRyaWJ1dGUoXCJkaXNhYmxlZFwiLCBcIlwiKTtcclxuICAgIH1cclxuICB9XHJcbn1cclxuZXhwb3J0IGRlZmF1bHQgRm9ybVZhbGlkYXRvcjtcclxuIl0sIm5hbWVzIjpbIl9fd2VicGFja19yZXF1aXJlX18iLCJwIiwiUE9QVVBfQUNUSVZFX0NMQVNTIiwiUG9wdXAiLCJjb25zdHJ1Y3RvciIsInNlbGVjdG9yIiwidGhpcyIsIl9zZWxlY3RvciIsIl9tb2RhbCIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsIl9oYW5kbGVFc2NLZXkiLCJiaW5kIiwiX2hhbmRsZUNsb3NlUG9wdXAiLCJldnQiLCJrZXkiLCJjbG9zZSIsInNldEV2ZW50TGlzdGVuZXJzIiwiYWRkRXZlbnRMaXN0ZW5lciIsInRhcmdldCIsImNsYXNzTGlzdCIsImNvbnRhaW5zIiwib3BlbiIsImFkZCIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJyZW1vdmUiLCJQb3B1cFdpdGhGb3JtcyIsImhhbmRsZVN1Ym1pdCIsInN1cGVyIiwiX2hhbmRsZVN1Ym1pdCIsIl9oYW5kbGVyV2l0aEZvcm0iLCJfZm9ybSIsIl9pbnB1dEZpZWxkcyIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJnZXRJbnB1dFZhbHVlcyIsImlucHV0VmFsdWVzIiwiZm9yRWFjaCIsImZpZWxkIiwibmFtZSIsInZhbHVlIiwiZGF0YSIsIl9zZXRJbnB1dFZhbHVlcyIsInZhbHVlcyIsIk9iamVjdCIsImtleXMiLCJwcmV2ZW50RGVmYXVsdCIsInJlc2V0IiwiYnRuRWRpdFByb2ZpbGUiLCJidG5BZGRDYXJkIiwiaW5pdGlhbENhcmRzIiwiaW1nVGl0bGUiLCJpbWdMaW5rIiwieW9zZW1pdGUiLCJhbHQiLCJsTG91aXNlIiwiYk1vdW50YWlucyIsImxhdGVtYXIiLCJ2YW5vaXNlIiwiY2FjdHVzIiwiZ2FsbGVyeVNlY3Rpb24iLCJpdGVtcyIsInJlbmRlcmVyIiwiX3JlbmRlckl0ZW1zIiwiX3JlbmRlcmVyIiwiX2NvbnRhaW5lciIsImFkZEl0ZW0iLCJpdGVtIiwiY2FyZCIsInByZXBlbmQiLCJfY2xlYXIiLCJpbm5lckhUTUwiLCJyZW5kZXJBbGwiLCJjYXJkRWxlbWVudCIsImhhbmRsZXIiLCJfbmFtZSIsIl9zcmMiLCJfaGFubGRlSW1nQ2xpY2siLCJfZ2V0VGVtcGxhdGUiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwiX2ltZyIsIl9jYXB0aW9uIiwiX3RyYXNoIiwiX2xpa2UiLCJtYWtlQ2FyZCIsIl9lbGVtZW50Iiwic2V0QXR0cmlidXRlIiwidGV4dENvbnRlbnQiLCJfYWRkTGlzdGVuZXJzIiwiX2hhbmRsZUxpa2VCdG4iLCJzcmMiLCJjbG9zZXN0IiwidG9nZ2xlIiwicG9wdXBJbWciLCJjcmVhdGVDYXJkIiwiX2ltYWdlIiwiZWRpdFByb2ZpbGUiLCJ1c2VySW5mbyIsInNldFVzZXJJbmZvIiwiYWRkQ2FyZCIsIl9uYW1lU2VsZWN0b3IiLCJuYW1lU2VsZWN0b3IiLCJfam9iU2VsZWN0b3IiLCJqb2JTZWxlY3RvciIsIl9uYW1lTm9kZSIsIl9qb2JOb2RlIiwiZ2V0VXNlckluZm8iLCJfam9iIiwiYWJvdXQiLCJuZXdEYXRhIiwiZm9ybVZhbGlkYXRvcnMiLCJzZXR0aW5ncyIsImZvcm1TZWxlY3RvciIsImlucHV0U2VsZWN0b3IiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJpbnB1dEVycm9yQ2xhc3MiLCJlcnJvckNsYXNzIiwiQXJyYXkiLCJmcm9tIiwiZm9ybUVsZW1lbnQiLCJ2YWxpZGF0b3IiLCJpbnB1dEVsZW1lbnQiLCJ2YWxpZGl0eSIsInZhbGlkIiwiX2hpZGVJbnB1dEVycm9yIiwiX3Nob3dJbnB1dEVycm9yIiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJlcnJvck1zZyIsImVycm9yRWxlbWVudCIsIl9mb3JtRWxlbWVudCIsImdldEF0dHJpYnV0ZSIsIl9zZXR0aW5ncyIsImlucHV0TGlzdCIsInNvbWUiLCJfaW5wdXRMaXN0IiwiX2J0bkVsZW1lbnQiLCJyZXNldFZhbGlkYXRpb24iLCJfdG9nZ2xlQnRuU3RhdGUiLCJlbmFibGVWYWxpZGF0aW9uIiwiX2hpZGVPclNob3dFcnJvciIsIl9oYXNJbnZhbGlkSW5wdXQiLCJyZW1vdmVBdHRyaWJ1dGUiLCJmb3JtTmFtZSJdLCJzb3VyY2VSb290IjoiIn0=